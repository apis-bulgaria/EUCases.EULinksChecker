<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"> <style>
	.KEYW {color: #933;}
	.COMM {color: #bbb; font-style: italic;}
	.NUMB {color: #393;}
	.STRN {color: #393;}
	.REGX {color: #339;}
	.line {border-right: 1px dotted #666; color: #666; font-style: normal;}
	</style></head><body><pre><span class='line'>  1</span> <span class="COMM">//'use strict';</span><span class="WHIT">
<span class='line'>  2</span> </span><span class="COMM">/** @name Global Constants
<span class='line'>  3</span>  *@description Common variables used throughout the AddIn
<span class='line'>  4</span>  **/</span><span class="WHIT">
<span class='line'>  5</span> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">cIdBusyBox</span><span class="PUNC">=</span><span class="STRN">'IdBusyBox'</span><span class="PUNC">,</span><span class="NAME">cIdModalBox</span><span class="PUNC">=</span><span class="STRN">'IdModalBox'</span><span class="PUNC">,</span><span class="NAME">cNone</span><span class="PUNC">=</span><span class="STRN">'none'</span><span class="PUNC">,</span><span class="NAME">cBlock</span><span class="PUNC">=</span><span class="STRN">'block'</span><span class="PUNC">,</span><span class="NAME">cHidden</span><span class="PUNC">=</span><span class="STRN">'hidden'</span><span class="PUNC">,</span><span class="NAME">cVisible</span><span class="PUNC">=</span><span class="STRN">'visible'</span><span class="PUNC">,</span><span class="NAME">cA</span><span class="PUNC">=</span><span class="STRN">'A'</span><span class="PUNC">,</span><span class="NAME">cDiv</span><span class="PUNC">=</span><span class="STRN">'div'</span><span class="PUNC">,</span><span class="NAME">cSpan</span><span class="PUNC">=</span><span class="STRN">'SPAN'</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>  6</span> </span><span class="WHIT">	</span><span class="NAME">cCnEuCasesLink</span><span class="PUNC">=</span><span class="STRN">'eucases-link'</span><span class="PUNC">,</span><span class="NAME">cCnEucasesTerm</span><span class="PUNC">=</span><span class="STRN">'eucases-term'</span><span class="PUNC">,</span><span class="NAME">cStyleId</span><span class="PUNC">=</span><span class="STRN">'StyleId'</span><span class="PUNC">,</span><span class="NAME">cVarsId</span><span class="PUNC">=</span><span class="STRN">'VarsId'</span><span class="PUNC">,</span><span class="NAME">cVars1Id</span><span class="PUNC">=</span><span class="STRN">'Vars1Id'</span><span class="PUNC">,</span><span class="NAME">cCommonProcsId</span><span class="PUNC">=</span><span class="STRN">'CommonProcsId'</span><span class="PUNC">,</span><span class="NAME">cModalProcsId</span><span class="PUNC">=</span><span class="STRN">'ModalProcsId'</span><span class="PUNC">,</span><span class="NAME">cModalResScrId</span><span class="PUNC">=</span><span class="STRN">'ModalResScrId'</span><span class="PUNC">,</span><span class="NAME">cModalResId</span><span class="PUNC">=</span><span class="STRN">'ModalResId'</span><span class="PUNC">,</span><span class="NAME">cUiLangId</span><span class="PUNC">=</span><span class="STRN">'UiLangId'</span><span class="PUNC">,</span><span class="NAME">cNotify</span><span class="PUNC">=</span><span class="STRN">'notifyme'</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>  7</span> </span><span class="WHIT">	</span><span class="NAME">cSymbol</span><span class="PUNC">=</span><span class="STRN">'symbol'</span><span class="PUNC">,</span><span class="NAME">cGET</span><span class="PUNC">=</span><span class="STRN">'GET'</span><span class="PUNC">,</span><span class="NAME">cUiLangIdx</span><span class="PUNC">=</span><span class="STRN">'UiLangIdx'</span><span class="PUNC">,</span><span class="NAME">cNewLinkInIdx</span><span class="PUNC">=</span><span class="STRN">'NewLinkInIdx'</span><span class="PUNC">,</span><span class="NAME">cTitle</span><span class="PUNC">=</span><span class="STRN">'title'</span><span class="PUNC">,</span><span class="NAME">cModalResult</span><span class="PUNC">=</span><span class="STRN">'ModalResult'</span><span class="PUNC">,</span><span class="NAME">cHead</span><span class="PUNC">=</span><span class="STRN">'head'</span><span class="PUNC">,</span><span class="NAME">ctA</span><span class="PUNC">=</span><span class="STRN">'A'</span><span class="PUNC">,</span><span class="NAME">ctI</span><span class="PUNC">=</span><span class="STRN">'I'</span><span class="PUNC">,</span><span class="NAME">ctE</span><span class="PUNC">=</span><span class="STRN">'E'</span><span class="PUNC">,</span><span class="NAME">ctX</span><span class="PUNC">=</span><span class="STRN">'X'</span><span class="PUNC">,</span><span class="NAME">ctW</span><span class="PUNC">=</span><span class="STRN">'W'</span><span class="PUNC">,</span><span class="NAME">ctQ</span><span class="PUNC">=</span><span class="STRN">'Q'</span><span class="PUNC">,</span><span class="NAME">cType</span><span class="PUNC">=</span><span class="STRN">'type'</span><span class="PUNC">,</span><span class="NAME">cMsg</span><span class="PUNC">=</span><span class="STRN">'msg'</span><span class="PUNC">,</span><span class="NAME">cOk</span><span class="PUNC">=</span><span class="STRN">'OK'</span><span class="PUNC">,</span><span class="NAME">cCancel</span><span class="PUNC">=</span><span class="STRN">'Cancel'</span><span class="PUNC">,</span><span class="NAME">cYes</span><span class="PUNC">=</span><span class="STRN">'Yes'</span><span class="PUNC">,</span><span class="NAME">cNo</span><span class="PUNC">=</span><span class="STRN">'No'</span><span class="PUNC">,</span><span class="NAME">cBut</span><span class="PUNC">=</span><span class="STRN">'but'</span><span class="PUNC">,</span><span class="NAME">cRes</span><span class="PUNC">=</span><span class="STRN">'res'</span><span class="PUNC">,</span><span class="NAME">cHttp_</span><span class="PUNC">=</span><span class="STRN">'http://'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>  8</span> </span><span class="COMM">/** @private */</span><span class="WHIT">
<span class='line'>  9</span> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">_alrt</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">console.log</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'> 10</span> </span><span class="COMM">/** @name aArg
<span class='line'> 11</span>  *@description Provides mechanism for the dialog boxes to analize the arguments passed upon its call
<span class='line'> 12</span>     @param n The name of the value.
<span class='line'> 13</span>     @param q The query string of the current location URL.
<span class='line'> 14</span>  */</span><span class="WHIT">
<span class='line'> 15</span> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">qArg</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 16</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">q</span><span class="PUNC">)</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">document.location.href</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 17</span> </span><span class="WHIT">	</span><span class="KEYW">try</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 18</span> </span><span class="WHIT">		</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">q.split</span><span class="PUNC">(</span><span class="STRN">'?'</span><span class="PUNC">)</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">split</span><span class="PUNC">(</span><span class="STRN">'&'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 19</span> </span><span class="WHIT">		</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">&lt;</span><span class="NAME">a.length</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 20</span> </span><span class="WHIT">			</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">split</span><span class="PUNC">(</span><span class="STRN">'='</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 21</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">==</span><span class="NAME">n</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="WHIT">
<span class='line'> 22</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'> 23</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="KEYW">catch</span><span class="PUNC">(</span><span class="NAME">_</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'> 24</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="STRN">''</span><span class="WHIT">
<span class='line'> 25</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'> 26</span> </span><span class="COMM">/** @name Msg
<span class='line'> 27</span>  *@description Provides a common mechanism to show messages to the user
<span class='line'> 28</span>     @param m The message to display.
<span class='line'> 29</span>     @param t The type of the dialog.
<span class='line'> 30</span>     @param b Bttons to be visible on the dialog.
<span class='line'> 31</span>  **/</span><span class="WHIT">
<span class='line'> 32</span> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">Msg</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 33</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">b</span><span class="PUNC">)</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">cOk</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 34</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">t</span><span class="PUNC">)</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">ctI</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 35</span> </span><span class="WHIT">	</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">x</span><span class="PUNC">=</span><span class="NAME">Components.classes</span><span class="PUNC">[</span><span class="STRN">'@mozilla.org/embedcomp/window-watcher;1'</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">getService</span><span class="PUNC">(</span><span class="NAME">Components.interfaces.nsIWindowWatcher</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 36</span> </span><span class="WHIT">	</span><span class="NAME">x.openWindow</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="STRN">'chrome://MNU/content/dlg.xul?'</span><span class="PUNC">+</span><span class="NAME">cType</span><span class="PUNC">+</span><span class="STRN">'='</span><span class="PUNC">+</span><span class="NAME">t</span><span class="PUNC">+</span><span class="STRN">'&'</span><span class="PUNC">+</span><span class="NAME">cMsg</span><span class="PUNC">+</span><span class="STRN">'='</span><span class="PUNC">+</span><span class="NAME">encodeURI</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">'&'</span><span class="PUNC">+</span><span class="NAME">cBut</span><span class="PUNC">+</span><span class="STRN">'='</span><span class="PUNC">+</span><span class="NAME">encodeURI</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="STRN">''</span><span class="PUNC">,</span><span class="STRN">'chrome,dialog,modal,centerscreen,alwaysRaised'</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">focus</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'> 37</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'> 38</span> </span><span class="COMM">/** @private */</span><span class="WHIT">
<span class='line'> 39</span> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">OkCancel</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="NAME">cOk</span><span class="PUNC">,</span><span class="NAME">cCancel</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">join</span><span class="PUNC">(</span><span class="STRN">','</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'> 40</span> </span><span class="COMM">/** @name ResOkCancel
<span class='line'> 41</span>  *@description Provides localized and "translated" OK-Cancel dialog box */</span><span class="WHIT">
<span class='line'> 42</span> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">ResOkCancel</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="NAME">cRes</span><span class="PUNC">,</span><span class="NAME">cOk</span><span class="PUNC">,</span><span class="NAME">cCancel</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">join</span><span class="PUNC">(</span><span class="STRN">','</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'> 43</span> </span><span class="COMM">/** @name Qst
<span class='line'> 44</span>  *@description Provides localized and "translated" Yes-No-Cancel dialog box 
<span class='line'> 45</span>   @param m The question to be shown.
<span class='line'> 46</span>   @param t The type of the dialog.
<span class='line'> 47</span>   @param b Buttons to be shown.
<span class='line'> 48</span>  * */</span><span class="WHIT">
<span class='line'> 49</span> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">Qst</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 50</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">b</span><span class="PUNC">)</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">OkCancel</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 51</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">t</span><span class="PUNC">)</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">ctQ</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 52</span> </span><span class="WHIT">	</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">r</span><span class="PUNC">=</span><span class="KEYW">false</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">=</span><span class="NAME">Components.classes</span><span class="PUNC">[</span><span class="STRN">'@mozilla.org/embedcomp/window-watcher;1'</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">getService</span><span class="PUNC">(</span><span class="NAME">Components.interfaces.nsIWindowWatcher</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 53</span> </span><span class="WHIT">	</span><span class="NAME">x.openWindow</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="STRN">'chrome://MNU/content/dlg.xul?'</span><span class="PUNC">+</span><span class="NAME">cType</span><span class="PUNC">+</span><span class="STRN">'='</span><span class="PUNC">+</span><span class="NAME">t</span><span class="PUNC">+</span><span class="STRN">'&'</span><span class="PUNC">+</span><span class="NAME">cMsg</span><span class="PUNC">+</span><span class="STRN">'='</span><span class="PUNC">+</span><span class="NAME">encodeURI</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">'&'</span><span class="PUNC">+</span><span class="NAME">cBut</span><span class="PUNC">+</span><span class="STRN">'='</span><span class="PUNC">+</span><span class="NAME">encodeURI</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="STRN">''</span><span class="PUNC">,</span><span class="STRN">'chrome,dialog,modal,centerscreen,alwaysRaised'</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">focus</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 54</span> </span><span class="WHIT">	</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">=</span><span class="NAME">GetStrPref</span><span class="PUNC">(</span><span class="NAME">cModalResult</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 55</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">y</span><span class="PUNC">)</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">y</span><span class="PUNC">==</span><span class="STRN">'1'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 56</span> </span><span class="WHIT">	</span><span class="NAME">SetStrPref</span><span class="PUNC">(</span><span class="NAME">cModalResult</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 57</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">r</span><span class="WHIT">
<span class='line'> 58</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'> 59</span> </span><span class="COMM">/** @name Inp
<span class='line'> 60</span>  @description Provides localized and "translated" input box 
<span class='line'> 61</span>   @param m The message to be shown.
<span class='line'> 62</span>   @param t The type of the dialog.
<span class='line'> 63</span>   @param r The result which is an object with member "v".
<span class='line'> 64</span> */</span><span class="WHIT">
<span class='line'> 65</span> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">Inp</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 66</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">t</span><span class="PUNC">)</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">ctQ</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 67</span> </span><span class="WHIT">	</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">x</span><span class="PUNC">=</span><span class="NAME">Components.classes</span><span class="PUNC">[</span><span class="STRN">'@mozilla.org/embedcomp/window-watcher;1'</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">getService</span><span class="PUNC">(</span><span class="NAME">Components.interfaces.nsIWindowWatcher</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">ResOkCancel</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 68</span> </span><span class="WHIT">	</span><span class="NAME">x.openWindow</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="STRN">'chrome://MNU/content/dlg.xul?'</span><span class="PUNC">+</span><span class="NAME">cType</span><span class="PUNC">+</span><span class="STRN">'='</span><span class="PUNC">+</span><span class="NAME">t</span><span class="PUNC">+</span><span class="STRN">'&'</span><span class="PUNC">+</span><span class="NAME">cMsg</span><span class="PUNC">+</span><span class="STRN">'='</span><span class="PUNC">+</span><span class="NAME">encodeURI</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">'&'</span><span class="PUNC">+</span><span class="NAME">cBut</span><span class="PUNC">+</span><span class="STRN">'='</span><span class="PUNC">+</span><span class="NAME">encodeURI</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">'&'</span><span class="PUNC">+</span><span class="NAME">cRes</span><span class="PUNC">+</span><span class="STRN">'='</span><span class="PUNC">+</span><span class="NAME">encodeURI</span><span class="PUNC">(</span><span class="NAME">r.v</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="STRN">''</span><span class="PUNC">,</span><span class="STRN">'chrome,dialog,modal,centerscreen,alwaysRaised'</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">focus</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 69</span> </span><span class="WHIT">	</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">=</span><span class="NAME">GetStrPref</span><span class="PUNC">(</span><span class="NAME">cModalResult</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 70</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">y</span><span class="PUNC">)</span><span class="NAME">r.v</span><span class="PUNC">=</span><span class="NAME">y</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 71</span> </span><span class="WHIT">	</span><span class="NAME">SetStrPref</span><span class="PUNC">(</span><span class="NAME">cModalResult</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 72</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">?</span><span class="KEYW">true</span><span class="PUNC">:</span><span class="KEYW">false</span><span class="WHIT">
<span class='line'> 73</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'> 74</span> </span><span class="COMM">/** @private */</span><span class="WHIT">
<span class='line'> 75</span> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">HG</span><span class="PUNC">(</span><span class="NAME">u</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 76</span> </span><span class="WHIT">	</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">x</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">XMLHttpRequest</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">s</span><span class="PUNC">=</span><span class="STRN">''</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 77</span> </span><span class="WHIT">	</span><span class="NAME">x.open</span><span class="PUNC">(</span><span class="NAME">cGET</span><span class="PUNC">,</span><span class="NAME">u</span><span class="PUNC">,</span><span class="KEYW">false</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 78</span> </span><span class="WHIT">	</span><span class="NAME">x.send</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 79</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">x.status</span><span class="PUNC">===</span><span class="NUMB">200</span><span class="PUNC">)</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">x.responseText</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 80</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">s</span><span class="WHIT">
<span class='line'> 81</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'> 82</span> </span><span class="COMM">/** @name Doc
<span class='line'> 83</span>  * @description Useful to access the document element of the current tab document from the AddIn itself */</span><span class="WHIT">
<span class='line'> 84</span> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">Doc</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 85</span> </span><span class="WHIT">	</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">x</span><span class="PUNC">=</span><span class="NAME">window.content</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 86</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">x</span><span class="PUNC">?</span><span class="NAME">x.document</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="WHIT">
<span class='line'> 87</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'> 88</span> </span><span class="COMM">/** @name DocBody
<span class='line'> 89</span>  @description Useful to access the document body element of the current tab document from the AddIn itself */</span><span class="WHIT">
<span class='line'> 90</span> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">DocBody</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 91</span> </span><span class="WHIT">	</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">x</span><span class="PUNC">=</span><span class="NAME">Doc</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 92</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">x</span><span class="PUNC">?</span><span class="NAME">x.body</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="WHIT">
<span class='line'> 93</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'> 94</span> </span><span class="COMM">/** @name DocBodyHtml
<span class='line'> 95</span>  @description Useful to access the HTML of the document body element of the current tab document from the AddIn itself */</span><span class="WHIT">
<span class='line'> 96</span> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">DocBodyHtml</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 97</span> </span><span class="WHIT">	</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">x</span><span class="PUNC">=</span><span class="NAME">DocBody</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 98</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">x</span><span class="PUNC">?</span><span class="NAME">x.innerHTML</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="WHIT">
<span class='line'> 99</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>100</span> </span><span class="COMM">/** @name GetElById
<span class='line'>101</span>  @description Presents the document.getElementById functionality from within the AddIn
<span class='line'>102</span>   @param i The id of the element to find.
<span class='line'>103</span>  **/</span><span class="WHIT">
<span class='line'>104</span> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">GetElById</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">x</span><span class="PUNC">=</span><span class="NAME">document.getElementById</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">x</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">x</span><span class="PUNC">=</span><span class="NAME">Doc</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">)</span><span class="NAME">x</span><span class="PUNC">=</span><span class="NAME">x.getElementById</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">x</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>105</span> </span><span class="COMM">/** @name GetElsByTagName
<span class='line'>106</span>  @description Presents the document.getElementsByTagName functionality from within the AddIn
<span class='line'>107</span>   @param i The TAG name to look for.
<span class='line'>108</span>  **/</span><span class="WHIT">
<span class='line'>109</span> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">GetElsByTagName</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">x</span><span class="PUNC">=</span><span class="NAME">Doc</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">x</span><span class="PUNC">?</span><span class="NAME">x.getElementsByTagName</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>110</span> </span><span class="COMM">/** @name ElsAtCursor
<span class='line'>111</span>  @description Returns the elements beneath the mouse cursor*/</span><span class="WHIT">
<span class='line'>112</span> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">ElsAtCursor</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>113</span> </span><span class="WHIT">	</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">Doc</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>114</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">d.querySelectorAll</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">d.querySelectorAll</span><span class="PUNC">(</span><span class="STRN">':hover'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>115</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT">
<span class='line'>116</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>117</span> </span><span class="COMM">/** @name LinkAtCursor1
<span class='line'>118</span>  @description Returns a HyperLink beneath the cursor, variant 1
<span class='line'>119</span>   @param e The window.event object.
<span class='line'>120</span>  */</span><span class="WHIT">
<span class='line'>121</span> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">LinkAtCursor1</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>122</span> </span><span class="WHIT">	</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">x</span><span class="PUNC">=</span><span class="NAME">e.clientX</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">=</span><span class="NAME">e.clientY</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>123</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">document.elementFromPoint</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">document.elementFromPoint</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>124</span> </span><span class="WHIT">	</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">Doc</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>125</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">d.elementFromPoint</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">d.elementFromPoint</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>126</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT">
<span class='line'>127</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>128</span> </span><span class="COMM">/** @name LinkAtCursor
<span class='line'>129</span>  @description Returns a HyperLink beneath the cursor
<span class='line'>130</span>   @param e The window.event object.
<span class='line'>131</span>  */</span><span class="WHIT">
<span class='line'>132</span> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">LinkAtCursor</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>133</span> </span><span class="WHIT">	</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">ElsAtCursor</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>134</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">l</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>135</span> </span><span class="WHIT">	</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">&lt;</span><span class="NAME">l.length</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">e.tagName</span><span class="PUNC">==</span><span class="NAME">cA</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>136</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">LinkAtCursor1</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>137</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>138</span> </span><span class="COMM">/** @private really private*/</span><span class="WHIT">
<span class='line'>139</span> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">GSN</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>140</span> </span><span class="WHIT">	</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">content.getSelection</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>141</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">s.isCollapsed</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>142</span> </span><span class="WHIT">	</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">x</span><span class="PUNC">=</span><span class="NAME">s.anchorNode</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">=</span><span class="NAME">s.focusNode</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">_CA</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>143</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">a</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>144</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">GNB</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>145</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>146</span> </span><span class="COMM">/** @private really private*/</span><span class="WHIT">
<span class='line'>147</span> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">_Pr</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>148</span> </span><span class="WHIT">	</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="NAME">n</span><span class="PUNC">]</span><span class="WHIT">
<span class='line'>149</span> </span><span class="WHIT">	</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">n.parentNode</span><span class="PUNC">)</span><span class="NAME">a.unshift</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>150</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="WHIT">
<span class='line'>151</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>152</span> </span><span class="COMM">/** @private really private*/</span><span class="WHIT">
<span class='line'>153</span> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">_CA</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>154</span> </span><span class="WHIT">	</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">_Pr</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">_Pr</span><span class="PUNC">(</span><span class="NAME">y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>155</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">!=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="STRN">'No common ancestor!'</span><span class="WHIT">
<span class='line'>156</span> </span><span class="WHIT">	</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">&lt;</span><span class="NAME">a.length</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">!=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="WHIT">
<span class='line'>157</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>158</span> </span><span class="COMM">/** @private really private*/</span><span class="WHIT">
<span class='line'>159</span> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">_IsD</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>160</span> </span><span class="WHIT">	</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>161</span> </span><span class="WHIT">	</span><span class="KEYW">while</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">!=</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>162</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">==</span><span class="NAME">p</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>163</span> </span><span class="WHIT">		</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">n.parentNode</span><span class="WHIT">
<span class='line'>164</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>165</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="WHIT">
<span class='line'>166</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>167</span> </span><span class="COMM">/** @private really private*/</span><span class="WHIT">
<span class='line'>168</span> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">GNB</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>169</span> </span><span class="WHIT">	</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">z</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>170</span> </span><span class="WHIT">	</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">&lt;</span><span class="NAME">r.childNodes.length</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>171</span> </span><span class="WHIT">		</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">r.childNodes</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="WHIT">
<span class='line'>172</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">_IsD</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">)</span><span class="PUNC">||</span><span class="NAME">_IsD</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>173</span> </span><span class="WHIT">			</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">z.length</span><span class="PUNC">==</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>174</span> </span><span class="WHIT">			</span><span class="NAME">z.push</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>175</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">z.length</span><span class="PUNC">==</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>176</span> </span><span class="WHIT">		</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="NAME">z.push</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>177</span> </span><span class="WHIT">		</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">z</span><span class="WHIT">
<span class='line'>178</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>179</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">z.length</span><span class="PUNC">==</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="NAME">r</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>180</span> </span><span class="WHIT">	</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">_IsD</span><span class="PUNC">(</span><span class="NAME">z</span><span class="PUNC">[</span><span class="NAME">z.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">)</span><span class="PUNC">||</span><span class="NAME">_IsD</span><span class="PUNC">(</span><span class="NAME">z</span><span class="PUNC">[</span><span class="NAME">z.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">z</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>181</span> </span><span class="WHIT">	</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="NAME">z</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="WHIT">
<span class='line'>182</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>183</span> </span><span class="COMM">/** @private really really private*/</span><span class="WHIT">
<span class='line'>184</span> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">_s</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>185</span> </span><span class="WHIT">	</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">content.getSelection</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>186</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">s.getRangeAt</span><span class="PUNC">&&</span><span class="NAME">s.rangeCount</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>187</span> </span><span class="WHIT">		</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">content.getSelection</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">getRangeAt</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>188</span> </span><span class="WHIT">		</span><span class="NAME">r.deleteContents</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>189</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">r.createContextualFragment</span><span class="PUNC">)</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">r.createContextualFragment</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>190</span> </span><span class="WHIT">		</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>191</span> </span><span class="WHIT">			</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">Doc</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">createElement</span><span class="PUNC">(</span><span class="NAME">cDiv</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>192</span> </span><span class="WHIT">			</span><span class="NAME">d.innerHTML</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>193</span> </span><span class="WHIT">			</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">Doc</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">createDocumentFragment</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>194</span> </span><span class="WHIT">			</span><span class="KEYW">while</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">d.firstChild</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="NAME">f.appendChild</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>195</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>196</span> </span><span class="WHIT">		</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">f.firstChild</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">f.lastChild</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>197</span> </span><span class="WHIT">		</span><span class="NAME">r.insertNode</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>198</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>199</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>200</span> </span><span class="WHIT">				</span><span class="NAME">r.setStartBefore</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>201</span> </span><span class="WHIT">				</span><span class="NAME">r.setEndAfter</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>202</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>203</span> </span><span class="WHIT">			</span><span class="NAME">s.removeAllRanges</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>204</span> </span><span class="WHIT">			</span><span class="NAME">s.addRange</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>205</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>206</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>207</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>208</span> </span><span class="COMM">/** @name OurLinksInSel
<span class='line'>209</span>  @description Returns list of anchor elements which the mouse cursor is over and which are placed by the AddIn
<span class='line'>210</span>  */</span><span class="WHIT">
<span class='line'>211</span> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">OurLinksInSel</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>212</span> </span><span class="WHIT">	</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">x</span><span class="PUNC">=</span><span class="NAME">GSN</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>213</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">x</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">x.length</span><span class="PUNC">==</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>214</span> </span><span class="WHIT">	</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">r</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>215</span> </span><span class="WHIT">	</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">&lt;</span><span class="NAME">x.length</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>216</span> </span><span class="WHIT">		</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">x</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">e.className</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>217</span> </span><span class="WHIT">		</span><span class="KEYW">try</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>218</span> </span><span class="WHIT">			</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">e.getElementsByTagName</span><span class="PUNC">(</span><span class="NAME">cA</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>219</span> </span><span class="WHIT">			</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">j</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">&lt;</span><span class="NAME">s.length</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">s</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">t.className</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">==</span><span class="NAME">cCnEuCasesLink</span><span class="PUNC">||</span><span class="NAME">f</span><span class="PUNC">==</span><span class="NAME">cCnEucasesTerm</span><span class="PUNC">)</span><span class="NAME">r.push</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>220</span> </span><span class="WHIT">			</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">e.getElementsByTagName</span><span class="PUNC">(</span><span class="NAME">cSpan</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>221</span> </span><span class="WHIT">			</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">j</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">&lt;</span><span class="NAME">s.length</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">s</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">t.className</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">==</span><span class="NAME">cCnEuCasesLink</span><span class="PUNC">||</span><span class="NAME">f</span><span class="PUNC">==</span><span class="NAME">cCnEucasesTerm</span><span class="PUNC">)</span><span class="NAME">r.push</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>222</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="KEYW">catch</span><span class="PUNC">(</span><span class="NAME">_</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">continue</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>223</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">!=</span><span class="NAME">cCnEuCasesLink</span><span class="PUNC">&&</span><span class="NAME">c</span><span class="PUNC">!=</span><span class="NAME">cCnEucasesTerm</span><span class="PUNC">)</span><span class="KEYW">continue</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>224</span> </span><span class="WHIT">		</span><span class="NAME">r.push</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>225</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>226</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">r</span><span class="WHIT">
<span class='line'>227</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>228</span> </span><span class="COMM">/** @name LinksInSel
<span class='line'>229</span>  @description Returns list of anchor elements which the mouse cursor is over
<span class='line'>230</span>  */</span><span class="WHIT">
<span class='line'>231</span> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">LinksInSel</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>232</span> </span><span class="WHIT">	</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">x</span><span class="PUNC">=</span><span class="NAME">GSN</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>233</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">x</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">x.length</span><span class="PUNC">==</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>234</span> </span><span class="WHIT">	</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">r</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>235</span> </span><span class="WHIT">	</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">&lt;</span><span class="NAME">x.length</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>236</span> </span><span class="WHIT">		</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">x</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>237</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">e.tagName</span><span class="PUNC">==</span><span class="NAME">cA</span><span class="PUNC">)</span><span class="NAME">r.push</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>238</span> </span><span class="WHIT">		</span><span class="KEYW">try</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>239</span> </span><span class="WHIT">			</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">e.getElementsByTagName</span><span class="PUNC">(</span><span class="NAME">cA</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>240</span> </span><span class="WHIT">			</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">j</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">&lt;</span><span class="NAME">s.length</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">r.push</span><span class="PUNC">(</span><span class="NAME">s</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>241</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="KEYW">catch</span><span class="PUNC">(</span><span class="NAME">_</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>242</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>243</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">r</span><span class="WHIT">
<span class='line'>244</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>245</span> </span><span class="COMM">/** @name Rm1Lnk
<span class='line'>246</span>  @description Removes the link passed as argument
<span class='line'>247</span>   @param l The link /"A" element/ to be removed.
<span class='line'>248</span>  **/</span><span class="WHIT">
<span class='line'>249</span> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">Rm1Lnk</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">)</span><span class="NAME">l.outerHTML</span><span class="PUNC">=</span><span class="NAME">l.innerHTML</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>250</span> </span><span class="COMM">/** @name _RmT
<span class='line'>251</span>  @description Removes links of specified tag
<span class='line'>252</span>   @param t The tag to be removed: "A"|"SPAN".
<span class='line'>253</span>  */</span><span class="WHIT">
<span class='line'>254</span> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">_RmT</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>255</span> </span><span class="WHIT">	</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>256</span> </span><span class="WHIT">	</span><span class="KEYW">do</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>257</span> </span><span class="WHIT">		</span><span class="NAME">f</span><span class="PUNC">=</span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>258</span> </span><span class="WHIT">		</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">GetElsByTagName</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>259</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a.length</span><span class="PUNC">==</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>260</span> </span><span class="WHIT">		</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">&lt;</span><span class="NAME">a.length</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>261</span> </span><span class="WHIT">			</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">e.className</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>262</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">!=</span><span class="NAME">cCnEuCasesLink</span><span class="PUNC">&&</span><span class="NAME">c</span><span class="PUNC">!=</span><span class="NAME">cCnEucasesTerm</span><span class="PUNC">)</span><span class="KEYW">continue</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>263</span> </span><span class="WHIT">			</span><span class="NAME">f</span><span class="PUNC">=</span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>264</span> </span><span class="WHIT">			</span><span class="NAME">Rm1Lnk</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>265</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>266</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="KEYW">while</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>267</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>268</span> </span><span class="COMM">/** @name removehyperlinks
<span class='line'>269</span>  @description Removes links set by the AddIn itself.
<span class='line'>270</span>  */</span><span class="WHIT">
<span class='line'>271</span> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">removehyperlinks</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>272</span> </span><span class="WHIT">	</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">x</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Rsrc</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>273</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">Qst</span><span class="PUNC">(</span><span class="NAME">x.cPlzConfirmRmLnkSel</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>274</span> </span><span class="WHIT">	</span><span class="KEYW">try</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>275</span> </span><span class="WHIT">		</span><span class="NAME">_RmT</span><span class="PUNC">(</span><span class="NAME">cA</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>276</span> </span><span class="WHIT">		</span><span class="NAME">_RmT</span><span class="PUNC">(</span><span class="NAME">cSpan</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>277</span> </span><span class="WHIT">		</span><span class="NAME">Msg</span><span class="PUNC">(</span><span class="NAME">x.cLinksRemoved</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>278</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="KEYW">catch</span><span class="PUNC">(</span><span class="NAME">_</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Msg</span><span class="PUNC">(</span><span class="NAME">_</span><span class="PUNC">,</span><span class="NAME">ctX</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>279</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>280</span> </span><span class="COMM">/** @description Extracts value of a key from the AddIn string bundle 
<span class='line'>281</span>   @param a The key of the value to be expanded.
<span class='line'>282</span>  **/</span><span class="WHIT">
<span class='line'>283</span> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">_x</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">document.getElementById</span><span class="PUNC">(</span><span class="STRN">'MNU-string-bundle'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">getString</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>284</span> </span><span class="COMM">/** Get selection text */</span><span class="WHIT">
<span class='line'>285</span> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">GetSelTxt</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>286</span> </span><span class="WHIT">	</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">t</span><span class="PUNC">=</span><span class="STRN">''</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>287</span> </span><span class="WHIT">	</span><span class="KEYW">try</span><span class="PUNC">{</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">content.getSelection</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">getRangeAt</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">catch</span><span class="PUNC">(</span><span class="NAME">_</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>288</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">t</span><span class="WHIT">
<span class='line'>289</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>290</span> </span><span class="COMM">/** @name IsLinkInSel 
<span class='line'>291</span>  @description Checks if there are any links in the selection which are set by the AddIn*/</span><span class="WHIT">
<span class='line'>292</span> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">IsLinkInSel</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>293</span> </span><span class="WHIT">	</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">t</span><span class="PUNC">=</span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>294</span> </span><span class="WHIT">	</span><span class="KEYW">try</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>295</span> </span><span class="WHIT">		</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">x</span><span class="PUNC">=</span><span class="NAME">content.getSelection</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">getElementsByTagName</span><span class="PUNC">(</span><span class="NAME">cA</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>296</span> </span><span class="WHIT">		</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">x.length</span><span class="PUNC">></span><span class="NUMB">0</span><span class="WHIT">
<span class='line'>297</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="KEYW">catch</span><span class="PUNC">(</span><span class="NAME">_</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">console.log</span><span class="PUNC">(</span><span class="NAME">_.message</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>298</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">t</span><span class="WHIT">
<span class='line'>299</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>300</span> </span><span class="COMM">/** @name ShowBusy
<span class='line'>301</span>  @description Shows BusyBox during long time-consuming operations*/</span><span class="WHIT">
<span class='line'>302</span> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">ShowBusy</span><span class="PUNC">(</span><span class="NAME">v</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>303</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">v</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>304</span> </span><span class="WHIT">		</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">r</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Rsrc</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>305</span> </span><span class="WHIT">		</span><span class="NAME">MNU.o.CurrentDoc</span><span class="PUNC">=</span><span class="NAME">Doc</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>306</span> </span><span class="WHIT">		</span><span class="NAME">MNU.o.CurrentDocBody</span><span class="PUNC">=</span><span class="NAME">DocBody</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>307</span> </span><span class="WHIT">		</span><span class="NAME">MNU.o.CurrentBusy</span><span class="PUNC">=</span><span class="NAME">MNU.o.CurrentDoc.createElement</span><span class="PUNC">(</span><span class="NAME">cDiv</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>308</span> </span><span class="WHIT">		</span><span class="NAME">MNU.o.CurrentBusy.id</span><span class="PUNC">=</span><span class="NAME">cIdBusyBox</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>309</span> </span><span class="WHIT">		</span><span class="NAME">MNU.o.CurrentBusy.innerHTML</span><span class="PUNC">=</span><span class="NAME">r.processingLinksMessage</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>310</span> </span><span class="WHIT">		</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">MNU.o.CurrentBusy.style</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>311</span> </span><span class="WHIT">		</span><span class="NAME">s.position</span><span class="PUNC">=</span><span class="STRN">'fixed'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>312</span> </span><span class="WHIT">		</span><span class="NAME">s.top</span><span class="PUNC">=</span><span class="STRN">'10px'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>313</span> </span><span class="WHIT">		</span><span class="NAME">s.left</span><span class="PUNC">=</span><span class="STRN">'10px'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>314</span> </span><span class="WHIT">		</span><span class="NAME">s.zIndex</span><span class="PUNC">=</span><span class="STRN">'1000'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>315</span> </span><span class="WHIT">		</span><span class="NAME">s.padding</span><span class="PUNC">=</span><span class="STRN">'10px'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>316</span> </span><span class="WHIT">		</span><span class="NAME">s.paddingLeft</span><span class="PUNC">=</span><span class="STRN">'20px'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>317</span> </span><span class="WHIT">		</span><span class="NAME">s.paddingRight</span><span class="PUNC">=</span><span class="STRN">'20px'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>318</span> </span><span class="WHIT">		</span><span class="NAME">s.border</span><span class="PUNC">=</span><span class="STRN">'5px solid grey'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>319</span> </span><span class="WHIT">		</span><span class="NAME">s.backgroundColor</span><span class="PUNC">=</span><span class="STRN">'white'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>320</span> </span><span class="WHIT">		</span><span class="NAME">s.fontSize</span><span class="PUNC">=</span><span class="STRN">'16px'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>321</span> </span><span class="WHIT">		</span><span class="NAME">s.fontWeight</span><span class="PUNC">=</span><span class="STRN">'bold'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>322</span> </span><span class="WHIT">		</span><span class="NAME">s.visibility</span><span class="PUNC">=</span><span class="NAME">cVisible</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>323</span> </span><span class="WHIT">		</span><span class="NAME">s.display</span><span class="PUNC">=</span><span class="NAME">cBlock</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>324</span> </span><span class="WHIT">		</span><span class="NAME">MNU.o.CurrentDocBody.appendChild</span><span class="PUNC">(</span><span class="NAME">MNU.o.CurrentBusy</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>325</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>326</span> </span><span class="WHIT">		</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">x</span><span class="PUNC">=</span><span class="NAME">MNU.o.CurrentDoc.getElementById</span><span class="PUNC">(</span><span class="NAME">cIdBusyBox</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>327</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">x</span><span class="PUNC">)</span><span class="NAME">x</span><span class="PUNC">=</span><span class="NAME">GetElById</span><span class="PUNC">(</span><span class="NAME">cIdBusyBox</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>328</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">x</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>329</span> </span><span class="WHIT">		</span><span class="KEYW">try</span><span class="PUNC">{</span><span class="NAME">MNU.o.CurrentDocBody.removeChild</span><span class="PUNC">(</span><span class="NAME">MNU.o.CurrentBusy</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">catch</span><span class="PUNC">(</span><span class="NAME">_</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>330</span> </span><span class="WHIT">		</span><span class="KEYW">try</span><span class="PUNC">{</span><span class="NAME">MNU.o.CurrentDocBody.removeChild</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">catch</span><span class="PUNC">(</span><span class="NAME">_</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>331</span> </span><span class="WHIT">		</span><span class="KEYW">try</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>332</span> </span><span class="WHIT">			</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">x.style</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>333</span> </span><span class="WHIT">			</span><span class="NAME">s.visibility</span><span class="PUNC">=</span><span class="NAME">cHidden</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>334</span> </span><span class="WHIT">			</span><span class="NAME">s.display</span><span class="PUNC">=</span><span class="NAME">cNone</span><span class="WHIT">
<span class='line'>335</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="KEYW">catch</span><span class="PUNC">(</span><span class="NAME">_</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>336</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>337</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>338</span> </span><span class="COMM">/** @name SetStrPref
<span class='line'>339</span>  @description Sets string preference in the mozilla settings storage which are further addressable from about:config 
<span class='line'>340</span>   @param k The key.
<span class='line'>341</span>   @param v The value.
<span class='line'>342</span>  */</span><span class="WHIT">
<span class='line'>343</span> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">SetStrPref</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">,</span><span class="NAME">v</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>344</span> </span><span class="WHIT">	</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">=</span><span class="NAME">Components.classes</span><span class="PUNC">[</span><span class="STRN">'@mozilla.org/preferences-service;1'</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">getService</span><span class="PUNC">(</span><span class="NAME">Components.interfaces.nsIPrefService</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">getBranch</span><span class="PUNC">(</span><span class="STRN">'extensions.MNU.'</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>345</span> </span><span class="WHIT">	</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">Components.classes</span><span class="PUNC">[</span><span class="STRN">"@mozilla.org/supports-string;1"</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">createInstance</span><span class="PUNC">(</span><span class="NAME">Components.interfaces.nsISupportsString</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>346</span> </span><span class="WHIT">	</span><span class="NAME">s.data</span><span class="PUNC">=</span><span class="NAME">v</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>347</span> </span><span class="WHIT">	</span><span class="NAME">p.setComplexValue</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">,</span><span class="NAME">Components.interfaces.nsISupportsString</span><span class="PUNC">,</span><span class="NAME">s</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>348</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>349</span> </span><span class="COMM">/** @name GetStrPref
<span class='line'>350</span>  @description Gets string preference from the the mozilla settings storage 
<span class='line'>351</span>   @param k The key.
<span class='line'>352</span>  */</span><span class="WHIT">
<span class='line'>353</span> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">GetStrPref</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>354</span> </span><span class="WHIT">	</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">r</span><span class="PUNC">=</span><span class="STRN">''</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NAME">Components.classes</span><span class="PUNC">[</span><span class="STRN">'@mozilla.org/preferences-service;1'</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">getService</span><span class="PUNC">(</span><span class="NAME">Components.interfaces.nsIPrefService</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">getBranch</span><span class="PUNC">(</span><span class="STRN">'extensions.MNU.'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>355</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">p.getPrefType</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">p.getComplexValue</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">,</span><span class="NAME">Components.interfaces.nsISupportsString</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">data</span><span class="PUNC">;</span><span class="COMM">//nsIPrefLocalizedString</span><span class="WHIT">
<span class='line'>356</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">r</span><span class="WHIT">
<span class='line'>357</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>358</span> </span><span class="COMM">/** @name GetPrefUiLang
<span class='line'>359</span>  @description Gets the index of the User Interface Language */</span><span class="WHIT">
<span class='line'>360</span> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">GetPrefUiLang</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>361</span> </span><span class="WHIT">	</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">=</span><span class="NAME">Components.classes</span><span class="PUNC">[</span><span class="STRN">'@mozilla.org/preferences-service;1'</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">getService</span><span class="PUNC">(</span><span class="NAME">Components.interfaces.nsIPrefService</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">getBranch</span><span class="PUNC">(</span><span class="STRN">'extensions.MNU.'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>362</span> </span><span class="WHIT">	</span><span class="KEYW">try</span><span class="PUNC">{</span><span class="NAME">p.getIntPref</span><span class="PUNC">(</span><span class="NAME">cUiLangIdx</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">catch</span><span class="PUNC">(</span><span class="NAME">_</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">p.setIntPref</span><span class="PUNC">(</span><span class="NAME">cUiLangIdx</span><span class="PUNC">,</span><span class="NUMB">4</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="COMM">//en!</span><span class="WHIT">
<span class='line'>363</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">p.getIntPref</span><span class="PUNC">(</span><span class="NAME">cUiLangIdx</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>364</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>365</span> </span><span class="COMM">/** @name GetPrefNewLinkTarget
<span class='line'>366</span>  @description Gets the target for the manually created links _blank | _top*/</span><span class="WHIT">
<span class='line'>367</span> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">GetPrefNewLinkTarget</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>368</span> </span><span class="WHIT">	</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">=</span><span class="NAME">Components.classes</span><span class="PUNC">[</span><span class="STRN">'@mozilla.org/preferences-service;1'</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">getService</span><span class="PUNC">(</span><span class="NAME">Components.interfaces.nsIPrefService</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">getBranch</span><span class="PUNC">(</span><span class="STRN">'extensions.MNU.'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>369</span> </span><span class="WHIT">	</span><span class="KEYW">try</span><span class="PUNC">{</span><span class="NAME">p.getIntPref</span><span class="PUNC">(</span><span class="NAME">cNewLinkInIdx</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">catch</span><span class="PUNC">(</span><span class="NAME">_</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">p.setIntPref</span><span class="PUNC">(</span><span class="NAME">cNewLinkInIdx</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="COMM">//_blank</span><span class="WHIT">
<span class='line'>370</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">p.getIntPref</span><span class="PUNC">(</span><span class="NAME">cNewLinkInIdx</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="STRN">'_blank'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>371</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="STRN">'_top'</span><span class="WHIT">
<span class='line'>372</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>373</span> </span><span class="COMM">/** @name LANG
<span class='line'>374</span>  @description Gets the User Interface language: en|bg|de|fr|it */</span><span class="WHIT">
<span class='line'>375</span> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">LANG</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>376</span> </span><span class="WHIT">	</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">x</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Rsrc</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>377</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">x.fLangByNum</span><span class="PUNC">(</span><span class="NAME">GetPrefUiLang</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>378</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>379</span> </span><span class="COMM">/** @class Rsrc
<span class='line'>380</span>  @description Provides a way to make the AddIn multilingual
<span class='line'>381</span>   @param aLang The string name of the language to use. Optional.
<span class='line'>382</span>  */</span><span class="WHIT">
<span class='line'>383</span> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">Rsrc</span><span class="PUNC">(</span><span class="NAME">aLang</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>384</span> </span><span class="WHIT">	</span><span class="COMM">/** @private */</span><span class="WHIT">
<span class='line'>385</span> </span><span class="WHIT">	</span><span class="NAME">this.Lang</span><span class="PUNC">=</span><span class="STRN">''</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>386</span> </span><span class="WHIT">	</span><span class="NAME">this.LangId</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>387</span> </span><span class="WHIT">	</span><span class="NAME">this.DocLang</span><span class="PUNC">=</span><span class="STRN">''</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>388</span> </span><span class="WHIT">	</span><span class="NAME">this.DocLangId</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>389</span> </span><span class="WHIT">	</span><span class="COMM">//</span><span class="WHIT">
<span class='line'>390</span> </span><span class="WHIT">	</span><span class="NAME">this.allDocs</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>391</span> </span><span class="WHIT">	</span><span class="NAME">this.euLegislation</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>392</span> </span><span class="WHIT">	</span><span class="NAME">this.euCaseLaw</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>393</span> </span><span class="WHIT">	</span><span class="NAME">this.natLegislation</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>394</span> </span><span class="WHIT">	</span><span class="NAME">this.natCaseLaw</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>395</span> </span><span class="WHIT">	</span><span class="NAME">this.removeLink</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>396</span> </span><span class="WHIT">	</span><span class="NAME">this.processingLinksMessage</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>397</span> </span><span class="WHIT">	</span><span class="NAME">this.confirmCheckForLinks</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>398</span> </span><span class="WHIT">	</span><span class="NAME">this.confirmRemoveLinks</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>399</span> </span><span class="WHIT">	</span><span class="NAME">this.cMsgNoLinksSetByELCFound</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>400</span> </span><span class="WHIT">	</span><span class="NAME">this.cPlsSelLink</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>401</span> </span><span class="WHIT">	</span><span class="NAME">this.cPlzConfirmRmLnkSel</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>402</span> </span><span class="WHIT">	</span><span class="NAME">this.cSuccess</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>403</span> </span><span class="WHIT">	</span><span class="NAME">this.cWaitUntilAsyncEnd</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>404</span> </span><span class="WHIT">	</span><span class="NAME">this.msgLoading</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>405</span> </span><span class="WHIT">	</span><span class="NAME">this.msgErrorHintLoading</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>406</span> </span><span class="WHIT">	</span><span class="NAME">this.cLang</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>407</span> </span><span class="WHIT">	</span><span class="NAME">this.OK</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>408</span> </span><span class="WHIT">	</span><span class="NAME">this.Cancel</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>409</span> </span><span class="WHIT">	</span><span class="NAME">this.cYes</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>410</span> </span><span class="WHIT">	</span><span class="NAME">this.cNo</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>411</span> </span><span class="WHIT">	</span><span class="NAME">this.cMsgChgLng</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>412</span> </span><span class="WHIT">	</span><span class="NAME">this.cCheckFrLinks</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>413</span> </span><span class="WHIT">	</span><span class="NAME">this.cRemoveLinks</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>414</span> </span><span class="WHIT">	</span><span class="NAME">this.cInsertLink</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>415</span> </span><span class="WHIT">	</span><span class="NAME">this.cRemoveLinksSel</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>416</span> </span><span class="WHIT">	</span><span class="NAME">this.Save2Xml</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>417</span> </span><span class="WHIT">	</span><span class="NAME">this.cm_Credentials</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>418</span> </span><span class="WHIT">	</span><span class="NAME">this.cLinksRemoved</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>419</span> </span><span class="WHIT">	</span><span class="NAME">this.cLinksRemovedFromSel</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>420</span> </span><span class="WHIT">	</span><span class="NAME">this.cPlzInpulLink</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>421</span> </span><span class="WHIT">	</span><span class="NAME">this.cInformation</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>422</span> </span><span class="WHIT">	</span><span class="NAME">this.cWarning</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>423</span> </span><span class="WHIT">	</span><span class="NAME">this.cError</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>424</span> </span><span class="WHIT">	</span><span class="NAME">this.cException</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>425</span> </span><span class="WHIT">	</span><span class="NAME">this.cQuestion</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>426</span> </span><span class="WHIT">	</span><span class="NAME">this.cNoLinksInSel</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>427</span> </span><span class="WHIT">	</span><span class="NAME">this.cNoSelection</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>428</span> </span><span class="WHIT">	</span><span class="NAME">this.cInsLinkSucc</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>429</span> </span><span class="WHIT">	</span><span class="NAME">this.cAttention</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>430</span> </span><span class="WHIT">	</span><span class="NAME">this.shortCite</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>431</span> </span><span class="WHIT">	</span><span class="NAME">this.fullCite</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>432</span> </span><span class="WHIT">	</span><span class="NAME">this.cTarget4NewLink</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>433</span> </span><span class="WHIT">	</span><span class="NAME">this.cTarget4NewLink_Blank</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>434</span> </span><span class="WHIT">	</span><span class="NAME">this.cTarget4NewLink_Self</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>435</span> </span><span class="WHIT">	</span><span class="NAME">this.cStAddNewLink</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>436</span> </span><span class="WHIT">	</span><span class="NAME">this.cStCredentials</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>437</span> </span><span class="WHIT">	</span><span class="NAME">this.cStPutLinksAndTerms</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>438</span> </span><span class="WHIT">	</span><span class="NAME">this.cStRemove1</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>439</span> </span><span class="WHIT">	</span><span class="NAME">this.cStRemoveLinksAndTerms</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>440</span> </span><span class="WHIT">	</span><span class="NAME">this.cStSave2Xml</span><span class="PUNC">=</span><span class="STRN">''</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>441</span> </span><span class="WHIT">	</span><span class="COMM">/** @method fLangNum
<span class='line'>442</span> 	@description Returns the language number 
<span class='line'>443</span>   @param l The string name of the language to use.
<span class='line'>444</span>  **/</span><span class="WHIT">
<span class='line'>445</span> </span><span class="WHIT">	</span><span class="NAME">this.fLangNum</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>446</span> </span><span class="WHIT">		</span><span class="KEYW">switch</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>447</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">'bg'</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>448</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">'de'</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">2</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>449</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">'fr'</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">3</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>450</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">'en'</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">4</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>451</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">'it'</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">5</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>452</span> </span><span class="WHIT">		</span><span class="KEYW">default</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">4</span><span class="WHIT">
<span class='line'>453</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>454</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>455</span> </span><span class="WHIT">	</span><span class="COMM">/** @method fLangByNum
<span class='line'>456</span> 	@description Returns the string presentation of the language enumerated by its number
<span class='line'>457</span>   @param i The ordinal number of the language to use.
<span class='line'>458</span>  **/</span><span class="WHIT">
<span class='line'>459</span> </span><span class="WHIT">	</span><span class="NAME">this.fLangByNum</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>460</span> </span><span class="WHIT">		</span><span class="KEYW">switch</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>461</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="STRN">'bg'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>462</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NUMB">2</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="STRN">'de'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>463</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NUMB">3</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="STRN">'fr'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>464</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NUMB">4</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="STRN">'en'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>465</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NUMB">5</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="STRN">'it'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>466</span> </span><span class="WHIT">		</span><span class="KEYW">default</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="STRN">'en'</span><span class="WHIT">
<span class='line'>467</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>468</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>469</span> </span><span class="WHIT">	</span><span class="COMM">/** @method WinLangNum
<span class='line'>470</span> 	@description Returns the Windows codepage associated with certain language
<span class='line'>471</span>   @param l The string name of the language to use.
<span class='line'>472</span>  **/</span><span class="WHIT">
<span class='line'>473</span> </span><span class="WHIT">	</span><span class="NAME">this.WinLangNum</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>474</span> </span><span class="WHIT">		</span><span class="KEYW">switch</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>475</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">'bg'</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">1026</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>476</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">'de'</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">1031</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>477</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">'fr'</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">1036</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>478</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">'en'</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">2057</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>479</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">'it'</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">1040</span><span class="WHIT">
<span class='line'>480</span> </span><span class="WHIT">		</span><span class="KEYW">default</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">2057</span><span class="WHIT">
<span class='line'>481</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>482</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>483</span> </span><span class="WHIT">	</span><span class="COMM">/** @method SetLangIdx
<span class='line'>484</span> 	@description Returns the Windows codepage associated with certain language
<span class='line'>485</span>   @param i The ordinal number of the language to use.
<span class='line'>486</span>  **/</span><span class="WHIT">
<span class='line'>487</span> </span><span class="WHIT">	</span><span class="NAME">this.SetLangIdx</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.SetLang</span><span class="PUNC">(</span><span class="NAME">this.fLangByNum</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>488</span> </span><span class="WHIT">	</span><span class="COMM">/** @method SetLang
<span class='line'>489</span> 	@description Returns the Windows codepage associated with certain language
<span class='line'>490</span>   @param i The string name of the language to use.
<span class='line'>491</span>  **/</span><span class="WHIT">
<span class='line'>492</span> </span><span class="WHIT">	</span><span class="NAME">this.SetLang</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>493</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">==</span><span class="NAME">this.Lang</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>494</span> </span><span class="WHIT">		</span><span class="NAME">this.Lang</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>495</span> </span><span class="WHIT">		</span><span class="NAME">this.LangId</span><span class="PUNC">=</span><span class="NAME">this.fLangNum</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>496</span> </span><span class="WHIT">		</span><span class="KEYW">switch</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>497</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">'bg'</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>498</span> </span><span class="WHIT">			</span><span class="NAME">this.allDocs</span><span class="PUNC">=</span><span class="STRN">' '</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>499</span> </span><span class="WHIT">			</span><span class="NAME">this.euLegislation</span><span class="PUNC">=</span><span class="STRN">' '</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>500</span> </span><span class="WHIT">			</span><span class="NAME">this.euCaseLaw</span><span class="PUNC">=</span><span class="STRN">'  '</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>501</span> </span><span class="WHIT">			</span><span class="NAME">this.natLegislation</span><span class="PUNC">=</span><span class="STRN">' '</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>502</span> </span><span class="WHIT">			</span><span class="NAME">this.natCaseLaw</span><span class="PUNC">=</span><span class="STRN">'  '</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>503</span> </span><span class="WHIT">			</span><span class="NAME">this.removeLink</span><span class="PUNC">=</span><span class="STRN">' '</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>504</span> </span><span class="WHIT">			</span><span class="NAME">this.processingLinksMessage</span><span class="PUNC">=</span><span class="STRN">'  ...'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>505</span> </span><span class="WHIT">			</span><span class="NAME">this.confirmCheckForLinks</span><span class="PUNC">=</span><span class="STRN">'EULinksChecker                     .      . , !'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>506</span> </span><span class="WHIT">			</span><span class="NAME">this.confirmRemoveLinks</span><span class="PUNC">=</span><span class="STRN">',    ,   EULinksChecker.'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>507</span> </span><span class="WHIT">			</span><span class="NAME">this.cMsgNoLinksSetByELCFound</span><span class="PUNC">=</span><span class="STRN">'   ,   EULinksChecker.'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>508</span> </span><span class="WHIT">			</span><span class="NAME">this.cPlsSelLink</span><span class="PUNC">=</span><span class="STRN">',    ,   EULinksChecker.'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>509</span> </span><span class="WHIT">			</span><span class="NAME">this.cPlzConfirmRmLnkSel</span><span class="PUNC">=</span><span class="STRN">',   EULinksChecker   . , !'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>510</span> </span><span class="WHIT">			</span><span class="NAME">this.cSuccess</span><span class="PUNC">=</span><span class="STRN">'   .'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>511</span> </span><span class="WHIT">			</span><span class="NAME">this.cWaitUntilAsyncEnd</span><span class="PUNC">=</span><span class="STRN">',     .'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>512</span> </span><span class="WHIT">			</span><span class="NAME">this.msgLoading</span><span class="PUNC">=</span><span class="STRN">'...'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>513</span> </span><span class="WHIT">			</span><span class="NAME">this.msgErrorHintLoading</span><span class="PUNC">=</span><span class="STRN">'  !   : &lt;a href="http://www.help.eucases.eu/ieaddin" target="_blank">www.help.eucases.eu/ieaddin&lt;/a>'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>514</span> </span><span class="WHIT">			</span><span class="NAME">this.cLang</span><span class="PUNC">=</span><span class="STRN">'  '</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>515</span> </span><span class="WHIT">			</span><span class="NAME">this.OK</span><span class="PUNC">=</span><span class="STRN">''</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>516</span> </span><span class="WHIT">			</span><span class="NAME">this.Cancel</span><span class="PUNC">=</span><span class="STRN">''</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>517</span> </span><span class="WHIT">			</span><span class="NAME">this.cYes</span><span class="PUNC">=</span><span class="STRN">''</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>518</span> </span><span class="WHIT">			</span><span class="NAME">this.cNo</span><span class="PUNC">=</span><span class="STRN">''</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>519</span> </span><span class="WHIT">			</span><span class="NAME">this.cMsgChgLng</span><span class="PUNC">=</span><span class="STRN">'        .'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>520</span> </span><span class="WHIT">			</span><span class="NAME">this.cCheckFrLinks</span><span class="PUNC">=</span><span class="STRN">'  '</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>521</span> </span><span class="WHIT">			</span><span class="NAME">this.cRemoveLinks</span><span class="PUNC">=</span><span class="STRN">' '</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>522</span> </span><span class="WHIT">			</span><span class="NAME">this.cInsertLink</span><span class="PUNC">=</span><span class="STRN">' '</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>523</span> </span><span class="WHIT">			</span><span class="NAME">this.cRemoveLinksSel</span><span class="PUNC">=</span><span class="STRN">'   '</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>524</span> </span><span class="WHIT">			</span><span class="NAME">this.Save2Xml</span><span class="PUNC">=</span><span class="STRN">'   XML-file'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>525</span> </span><span class="WHIT">			</span><span class="NAME">this.cm_Credentials</span><span class="PUNC">=</span><span class="STRN">''</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>526</span> </span><span class="WHIT">			</span><span class="NAME">this.cLinksRemoved</span><span class="PUNC">=</span><span class="STRN">'   '</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>527</span> </span><span class="WHIT">			</span><span class="NAME">this.cLinksRemovedFromSel</span><span class="PUNC">=</span><span class="STRN">'     '</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>528</span> </span><span class="WHIT">			</span><span class="NAME">this.cPlzInpulLink</span><span class="PUNC">=</span><span class="STRN">',  :'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>529</span> </span><span class="WHIT">			</span><span class="NAME">this.cInformation</span><span class="PUNC">=</span><span class="STRN">''</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>530</span> </span><span class="WHIT">			</span><span class="NAME">this.cWarning</span><span class="PUNC">=</span><span class="STRN">''</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>531</span> </span><span class="WHIT">			</span><span class="NAME">this.cError</span><span class="PUNC">=</span><span class="STRN">''</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>532</span> </span><span class="WHIT">			</span><span class="NAME">this.cException</span><span class="PUNC">=</span><span class="STRN">''</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>533</span> </span><span class="WHIT">			</span><span class="NAME">this.cQuestion</span><span class="PUNC">=</span><span class="STRN">''</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>534</span> </span><span class="WHIT">			</span><span class="NAME">this.cNoLinksInSel</span><span class="PUNC">=</span><span class="STRN">'   '</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>535</span> </span><span class="WHIT">			</span><span class="NAME">this.cNoSelection</span><span class="PUNC">=</span><span class="STRN">'  .'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>536</span> </span><span class="WHIT">			</span><span class="NAME">this.cInsLinkSucc</span><span class="PUNC">=</span><span class="STRN">'    .'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>537</span> </span><span class="WHIT">			</span><span class="NAME">this.cAttention</span><span class="PUNC">=</span><span class="STRN">''</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>538</span> </span><span class="WHIT">			</span><span class="NAME">this.shortCite</span><span class="PUNC">=</span><span class="STRN">' '</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>539</span> </span><span class="WHIT">			</span><span class="NAME">this.fullCite</span><span class="PUNC">=</span><span class="STRN">' '</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>540</span> </span><span class="WHIT">			</span><span class="NAME">this.cTarget4NewLink</span><span class="PUNC">=</span><span class="STRN">'     :'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>541</span> </span><span class="WHIT">			</span><span class="NAME">this.cTarget4NewLink_Blank</span><span class="PUNC">=</span><span class="STRN">' '</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>542</span> </span><span class="WHIT">			</span><span class="NAME">this.cTarget4NewLink_Self</span><span class="PUNC">=</span><span class="STRN">' '</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>543</span> </span><span class="WHIT">			</span><span class="NAME">this.cStPutLinksAndTerms</span><span class="PUNC">=</span><span class="STRN">'            '</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>544</span> </span><span class="WHIT">			</span><span class="NAME">this.cStAddNewLink</span><span class="PUNC">=</span><span class="STRN">'       '</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>545</span> </span><span class="WHIT">			</span><span class="NAME">this.cStCredentials</span><span class="PUNC">=</span><span class="STRN">''</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>546</span> </span><span class="WHIT">			</span><span class="NAME">this.cStRemove1</span><span class="PUNC">=</span><span class="STRN">'       EULinksChecker         '</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>547</span> </span><span class="WHIT">			</span><span class="NAME">this.cStRemoveLinksAndTerms</span><span class="PUNC">=</span><span class="STRN">'          ,   EULinksChecker   "  "'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>548</span> </span><span class="WHIT">			</span><span class="NAME">this.cStSave2Xml</span><span class="PUNC">=</span><span class="STRN">'   XML-file'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>549</span> </span><span class="WHIT">			</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>550</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">'de'</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>551</span> </span><span class="WHIT">			</span><span class="NAME">this.allDocs</span><span class="PUNC">=</span><span class="STRN">'Alle Dokumente'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>552</span> </span><span class="WHIT">			</span><span class="NAME">this.euLegislation</span><span class="PUNC">=</span><span class="STRN">'EU-Gesetzgebung'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>553</span> </span><span class="WHIT">			</span><span class="NAME">this.euCaseLaw</span><span class="PUNC">=</span><span class="STRN">'EU-Rechtsprechung'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>554</span> </span><span class="WHIT">			</span><span class="NAME">this.natLegislation</span><span class="PUNC">=</span><span class="STRN">'Nationale Gesetzgebung'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>555</span> </span><span class="WHIT">			</span><span class="NAME">this.natCaseLaw</span><span class="PUNC">=</span><span class="STRN">'Nationale Rechtsprechung'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>556</span> </span><span class="WHIT">			</span><span class="NAME">this.removeLink</span><span class="PUNC">=</span><span class="STRN">'Link entfernen'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>557</span> </span><span class="WHIT">			</span><span class="NAME">this.processingLinksMessage</span><span class="PUNC">=</span><span class="STRN">'berprfen Sie fr Links...'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>558</span> </span><span class="WHIT">			</span><span class="NAME">this.confirmCheckForLinks</span><span class="PUNC">=</span><span class="STRN">'EULinksChecker wird berprfen ob Verweise auf EU-Gesetzgebung oder Rechtsprechung  vorhanden sind und wird Links zu den zitierten Rechtsakten einfgen. Dies kann eine Weile dauern. Bitte, besttigen!'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>559</span> </span><span class="WHIT">			</span><span class="NAME">this.confirmRemoveLinks</span><span class="PUNC">=</span><span class="STRN">'Bitte besttigen Sie die Entfernung von Links gesetzt von EULinksCheker.'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>560</span> </span><span class="WHIT">			</span><span class="NAME">this.cMsgNoLinksSetByELCFound</span><span class="PUNC">=</span><span class="STRN">'Keine Links vom EULinksChecker gefunden.'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>561</span> </span><span class="WHIT">			</span><span class="NAME">this.cPlsSelLink</span><span class="PUNC">=</span><span class="STRN">'Bitte, whlen Sie einen Text mit Links gesetzt vom EULinksChecker.'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>562</span> </span><span class="WHIT">			</span><span class="NAME">this.cPlzConfirmRmLnkSel</span><span class="PUNC">=</span><span class="STRN">'Die vom EULinksChecker gesetzten Links werden gelscht. Bitte, besttigen!'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>563</span> </span><span class="WHIT">			</span><span class="NAME">this.cSuccess</span><span class="PUNC">=</span><span class="STRN">'berprfung fr Links abgeschlossen.'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>564</span> </span><span class="WHIT">			</span><span class="NAME">this.cWaitUntilAsyncEnd</span><span class="PUNC">=</span><span class="STRN">'Bitte warten Sie bis der asynchronische Vorgang abgeschlossen ist.'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>565</span> </span><span class="WHIT">			</span><span class="NAME">this.msgLoading</span><span class="PUNC">=</span><span class="STRN">'Laden...'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>566</span> </span><span class="WHIT">			</span><span class="NAME">this.msgErrorHintLoading</span><span class="PUNC">=</span><span class="STRN">'Fehler beim Laden! Fr mehr Information: &lt;a href="http://www.help.eucases.eu/ieaddin" target="_blank">www.help.eucases.eu/ieaddin&lt;/a>'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>567</span> </span><span class="WHIT">			</span><span class="NAME">this.cLang</span><span class="PUNC">=</span><span class="STRN">'Sprache'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>568</span> </span><span class="WHIT">			</span><span class="NAME">this.OK</span><span class="PUNC">=</span><span class="STRN">'OK'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>569</span> </span><span class="WHIT">			</span><span class="NAME">this.Cancel</span><span class="PUNC">=</span><span class="STRN">'Stornier'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>570</span> </span><span class="WHIT">			</span><span class="NAME">this.cYes</span><span class="PUNC">=</span><span class="STRN">'Ja'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>571</span> </span><span class="WHIT">			</span><span class="NAME">this.cNo</span><span class="PUNC">=</span><span class="STRN">'Nein'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>572</span> </span><span class="WHIT">			</span><span class="NAME">this.cMsgChgLng</span><span class="PUNC">=</span><span class="STRN">'Sie sind dabei, die Sprache der Benutzeroberflche zu ndern.'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>573</span> </span><span class="WHIT">			</span><span class="NAME">this.cCheckFrLinks</span><span class="PUNC">=</span><span class="STRN">'berprfung fr Links'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>574</span> </span><span class="WHIT">			</span><span class="NAME">this.cRemoveLinks</span><span class="PUNC">=</span><span class="STRN">'Links entfernen'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>575</span> </span><span class="WHIT">			</span><span class="NAME">this.cInsertLink</span><span class="PUNC">=</span><span class="STRN">'Link setzen'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>576</span> </span><span class="WHIT">			</span><span class="NAME">this.cRemoveLinksSel</span><span class="PUNC">=</span><span class="STRN">'Links von Selektion entfernen'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>577</span> </span><span class="WHIT">			</span><span class="NAME">this.Save2Xml</span><span class="PUNC">=</span><span class="STRN">'Text in XML-Datei speichern'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>578</span> </span><span class="WHIT">			</span><span class="NAME">this.cm_Credentials</span><span class="PUNC">=</span><span class="STRN">'Einstellungen'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>579</span> </span><span class="WHIT">			</span><span class="NAME">this.cLinksRemoved</span><span class="PUNC">=</span><span class="STRN">'Links wurden entfernt.'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>580</span> </span><span class="WHIT">			</span><span class="NAME">this.cLinksRemovedFromSel</span><span class="PUNC">=</span><span class="STRN">'Links wurden entfernt.'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>581</span> </span><span class="WHIT">			</span><span class="NAME">this.cPlzInpulLink</span><span class="PUNC">=</span><span class="STRN">'Bitte, enter address:'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>582</span> </span><span class="WHIT">			</span><span class="NAME">this.cInformation</span><span class="PUNC">=</span><span class="STRN">'Information'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>583</span> </span><span class="WHIT">			</span><span class="NAME">this.cWarning</span><span class="PUNC">=</span><span class="STRN">'Warnung'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>584</span> </span><span class="WHIT">			</span><span class="NAME">this.cError</span><span class="PUNC">=</span><span class="STRN">'Fehler'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>585</span> </span><span class="WHIT">			</span><span class="NAME">this.cException</span><span class="PUNC">=</span><span class="STRN">'Ausnahme'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>586</span> </span><span class="WHIT">			</span><span class="NAME">this.cQuestion</span><span class="PUNC">=</span><span class="STRN">'Frage'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>587</span> </span><span class="WHIT">			</span><span class="NAME">this.cNoLinksInSel</span><span class="PUNC">=</span><span class="STRN">'Keine Links vorhanden'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>588</span> </span><span class="WHIT">			</span><span class="NAME">this.cNoSelection</span><span class="PUNC">=</span><span class="STRN">'Es ist nichts ausgewhlt.'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>589</span> </span><span class="WHIT">			</span><span class="NAME">this.cInsLinkSucc</span><span class="PUNC">=</span><span class="STRN">'Linkssetzung erfolgreich abgelaufen.'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>590</span> </span><span class="WHIT">			</span><span class="NAME">this.cAttention</span><span class="PUNC">=</span><span class="STRN">'Achtung'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>591</span> </span><span class="WHIT">			</span><span class="NAME">this.shortCite</span><span class="PUNC">=</span><span class="STRN">'Kurzes Zitat'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>592</span> </span><span class="WHIT">			</span><span class="NAME">this.fullCite</span><span class="PUNC">=</span><span class="STRN">'Vollstndiges Zitat'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>593</span> </span><span class="WHIT">			</span><span class="NAME">this.cTarget4NewLink</span><span class="PUNC">=</span><span class="STRN">'Die neuen Links sind in .geffnet:'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>594</span> </span><span class="WHIT">			</span><span class="NAME">this.cTarget4NewLink_Blank</span><span class="PUNC">=</span><span class="STRN">'ein neues Fenster'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>595</span> </span><span class="WHIT">			</span><span class="NAME">this.cTarget4NewLink_Self</span><span class="PUNC">=</span><span class="STRN">'das gleiche Fenster'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>596</span> </span><span class="WHIT">			</span><span class="NAME">this.cStPutLinksAndTerms</span><span class="PUNC">=</span><span class="STRN">'Erkennung und Hervorhebung von Verweisen auf EU-Gesetzgebung und Rechtsprechung'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>597</span> </span><span class="WHIT">			</span><span class="NAME">this.cStAddNewLink</span><span class="PUNC">=</span><span class="STRN">'Manuelle Einfgung vom Link zur externen Web-Ressource'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>598</span> </span><span class="WHIT">			</span><span class="NAME">this.cStCredentials</span><span class="PUNC">=</span><span class="STRN">'Einstellungen'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>599</span> </span><span class="WHIT">			</span><span class="NAME">this.cStRemove1</span><span class="PUNC">=</span><span class="STRN">'Entfernung von den vom EULinksChecker gesetzten Links die auf EU-Gesetzgebung und Rechtsprechung verweisen'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>600</span> </span><span class="WHIT">			</span><span class="NAME">this.cStRemoveLinksAndTerms</span><span class="PUNC">=</span><span class="STRN">'Entfernung der Links gesetzt von "berprfen Sie fr Links" Funktion des EULinksCheckers'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>601</span> </span><span class="WHIT">			</span><span class="NAME">this.cStSave2Xml</span><span class="PUNC">=</span><span class="STRN">'Speichern Sie den Text in XML-file'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>602</span> </span><span class="WHIT">			</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>603</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">'fr'</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>604</span> </span><span class="WHIT">			</span><span class="NAME">this.allDocs</span><span class="PUNC">=</span><span class="STRN">'Tous les documents'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>605</span> </span><span class="WHIT">			</span><span class="NAME">this.euLegislation</span><span class="PUNC">=</span><span class="STRN">'Lgislation de l\'UE'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>606</span> </span><span class="WHIT">			</span><span class="NAME">this.euCaseLaw</span><span class="PUNC">=</span><span class="STRN">'Jurisprudence de l\'UE'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>607</span> </span><span class="WHIT">			</span><span class="NAME">this.natLegislation</span><span class="PUNC">=</span><span class="STRN">'Lgislation nationale'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>608</span> </span><span class="WHIT">			</span><span class="NAME">this.natCaseLaw</span><span class="PUNC">=</span><span class="STRN">'Jurisprudence nationale'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>609</span> </span><span class="WHIT">			</span><span class="NAME">this.removeLink</span><span class="PUNC">=</span><span class="STRN">'Supprimer le lien'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>610</span> </span><span class="WHIT">			</span><span class="NAME">this.processingLinksMessage</span><span class="PUNC">=</span><span class="STRN">'Vrifier les liens...'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>611</span> </span><span class="WHIT">			</span><span class="NAME">this.confirmCheckForLinks</span><span class="PUNC">=</span><span class="STRN">'EULinksChecker vrifiera sil existe des rfrences menant vers la lgislation et la jurisprudence de l\'Union europenne et mettra des liens vers les dispositions cits. Cela peut prendre un certain temps.Veuillez  confirmer!'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>612</span> </span><span class="WHIT">			</span><span class="NAME">this.confirmRemoveLinks</span><span class="PUNC">=</span><span class="STRN">'Veuillez confirmer la suppression des liens tablis par EULinksChecker.'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>613</span> </span><span class="WHIT">			</span><span class="NAME">this.cMsgNoLinksSetByELCFound</span><span class="PUNC">=</span><span class="STRN">'Aucun lien tabli par EULinksChecker.'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>614</span> </span><span class="WHIT">			</span><span class="NAME">this.cPlsSelLink</span><span class="PUNC">=</span><span class="STRN">'Veuillez slectionner le texte avec des liens tablis par EULinksChecker.'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>615</span> </span><span class="WHIT">			</span><span class="NAME">this.cPlzConfirmRmLnkSel</span><span class="PUNC">=</span><span class="STRN">'Les liens tablis par EULinksChecker seront supprims. Veuillez confirmer!'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>616</span> </span><span class="WHIT">			</span><span class="NAME">this.cSuccess</span><span class="PUNC">=</span><span class="STRN">'La vrification des liens est termine.'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>617</span> </span><span class="WHIT">			</span><span class="NAME">this.cWaitUntilAsyncEnd</span><span class="PUNC">=</span><span class="STRN">'Veuillez attendre la fin de l\'opration asynchrone'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>618</span> </span><span class="WHIT">			</span><span class="NAME">this.msgLoading</span><span class="PUNC">=</span><span class="STRN">'Chargement...'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>619</span> </span><span class="WHIT">			</span><span class="NAME">this.msgErrorHintLoading</span><span class="PUNC">=</span><span class="STRN">'Erreur de chargement! Pour plus de renseignements: &lt;a href="http://www.help.eucases.eu/ieaddin" target="_blank">www.help.eucases.eu/ieaddin&lt;/a>'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>620</span> </span><span class="WHIT">			</span><span class="NAME">this.cLang</span><span class="PUNC">=</span><span class="STRN">'Langue de l\'interface'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>621</span> </span><span class="WHIT">			</span><span class="NAME">this.OK</span><span class="PUNC">=</span><span class="STRN">'Confirmer'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>622</span> </span><span class="WHIT">			</span><span class="NAME">this.Cancel</span><span class="PUNC">=</span><span class="STRN">'Annuler'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>623</span> </span><span class="WHIT">			</span><span class="NAME">this.cYes</span><span class="PUNC">=</span><span class="STRN">'Oui'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>624</span> </span><span class="WHIT">			</span><span class="NAME">this.cNo</span><span class="PUNC">=</span><span class="STRN">'Non'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>625</span> </span><span class="WHIT">			</span><span class="NAME">this.cMsgChgLng</span><span class="PUNC">=</span><span class="STRN">'Vous tes sur le point de changer la langue de l\'interface utilisateur.'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>626</span> </span><span class="WHIT">			</span><span class="NAME">this.cCheckFrLinks</span><span class="PUNC">=</span><span class="STRN">'Vrifier les liens'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>627</span> </span><span class="WHIT">			</span><span class="NAME">this.cRemoveLinks</span><span class="PUNC">=</span><span class="STRN">'Supprimer les liens'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>628</span> </span><span class="WHIT">			</span><span class="NAME">this.cInsertLink</span><span class="PUNC">=</span><span class="STRN">'Insrer un lien'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>629</span> </span><span class="WHIT">			</span><span class="NAME">this.cRemoveLinksSel</span><span class="PUNC">=</span><span class="STRN">'Supprimer les liens de la selection'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>630</span> </span><span class="WHIT">			</span><span class="NAME">this.Save2Xml</span><span class="PUNC">=</span><span class="STRN">'Enregistrer le texte au format XML'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>631</span> </span><span class="WHIT">			</span><span class="NAME">this.cm_Credentials</span><span class="PUNC">=</span><span class="STRN">'Paramtres'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>632</span> </span><span class="WHIT">			</span><span class="NAME">this.cLinksRemoved</span><span class="PUNC">=</span><span class="STRN">'Les liens sont supprims.'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>633</span> </span><span class="WHIT">			</span><span class="NAME">this.cLinksRemovedFromSel</span><span class="PUNC">=</span><span class="STRN">'Les liens de la slection sont supprims.'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>634</span> </span><span class="WHIT">			</span><span class="NAME">this.cPlzInpulLink</span><span class="PUNC">=</span><span class="STRN">'Veuillez entrer une adresse:'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>635</span> </span><span class="WHIT">			</span><span class="NAME">this.cInformation</span><span class="PUNC">=</span><span class="STRN">'Information'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>636</span> </span><span class="WHIT">			</span><span class="NAME">this.cWarning</span><span class="PUNC">=</span><span class="STRN">'Avertissement'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>637</span> </span><span class="WHIT">			</span><span class="NAME">this.cError</span><span class="PUNC">=</span><span class="STRN">'Erreur'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>638</span> </span><span class="WHIT">			</span><span class="NAME">this.cException</span><span class="PUNC">=</span><span class="STRN">'Exception'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>639</span> </span><span class="WHIT">			</span><span class="NAME">this.cQuestion</span><span class="PUNC">=</span><span class="STRN">'Question'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>640</span> </span><span class="WHIT">			</span><span class="NAME">this.cNoLinksInSel</span><span class="PUNC">=</span><span class="STRN">'Aucun lien dans la slection'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>641</span> </span><span class="WHIT">			</span><span class="NAME">this.cNoSelection</span><span class="PUNC">=</span><span class="STRN">'Aucune slection.'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>642</span> </span><span class="WHIT">			</span><span class="NAME">this.cInsLinkSucc</span><span class="PUNC">=</span><span class="STRN">'L\'tablissement du lien a reussi.'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>643</span> </span><span class="WHIT">			</span><span class="NAME">this.cAttention</span><span class="PUNC">=</span><span class="STRN">'Attention'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>644</span> </span><span class="WHIT">			</span><span class="NAME">this.shortCite</span><span class="PUNC">=</span><span class="STRN">'Courte citation'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>645</span> </span><span class="WHIT">			</span><span class="NAME">this.fullCite</span><span class="PUNC">=</span><span class="STRN">'Citation complte'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>646</span> </span><span class="WHIT">			</span><span class="NAME">this.cTarget4NewLink</span><span class="PUNC">=</span><span class="STRN">'Les nouveaux liens s\'ouvrent dans:'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>647</span> </span><span class="WHIT">			</span><span class="NAME">this.cTarget4NewLink_Blank</span><span class="PUNC">=</span><span class="STRN">'une nouvelle fentre'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>648</span> </span><span class="WHIT">			</span><span class="NAME">this.cTarget4NewLink_Self</span><span class="PUNC">=</span><span class="STRN">'la mme fentre'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>649</span> </span><span class="WHIT">			</span><span class="NAME">this.cStPutLinksAndTerms</span><span class="PUNC">=</span><span class="STRN">'Identification et le marquage des rfrences vers la lgislation et la jurisprudence de l\'Union europenne'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>650</span> </span><span class="WHIT">			</span><span class="NAME">this.cStAddNewLink</span><span class="PUNC">=</span><span class="STRN">'Insrez manuellement un lien vers une ressource Web externe'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>651</span> </span><span class="WHIT">			</span><span class="NAME">this.cStCredentials</span><span class="PUNC">=</span><span class="STRN">'Paramtres'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>652</span> </span><span class="WHIT">			</span><span class="NAME">this.cStRemove1</span><span class="PUNC">=</span><span class="STRN">'Retrait de liens menant vers la lgislation et la jurisprudence de l\'UE tablis par EULinksChecker  partir du texte slectionn'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>653</span> </span><span class="WHIT">			</span><span class="NAME">this.cStRemoveLinksAndTerms</span><span class="PUNC">=</span><span class="STRN">'Retrait de liens menant vers la lgislation et la jurisprudence de l\'UE tablis par EULinksChecker avec la fonction "Vrifier les liens"'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>654</span> </span><span class="WHIT">			</span><span class="NAME">this.cStSave2Xml</span><span class="PUNC">=</span><span class="STRN">'Enregistrer le texte au format XML'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>655</span> </span><span class="WHIT">			</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>656</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">'en'</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>657</span> </span><span class="WHIT">			</span><span class="NAME">this.allDocs</span><span class="PUNC">=</span><span class="STRN">'All documents'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>658</span> </span><span class="WHIT">			</span><span class="NAME">this.euLegislation</span><span class="PUNC">=</span><span class="STRN">'EU legislation'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>659</span> </span><span class="WHIT">			</span><span class="NAME">this.euCaseLaw</span><span class="PUNC">=</span><span class="STRN">'EU case law'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>660</span> </span><span class="WHIT">			</span><span class="NAME">this.natLegislation</span><span class="PUNC">=</span><span class="STRN">'National legislation'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>661</span> </span><span class="WHIT">			</span><span class="NAME">this.natCaseLaw</span><span class="PUNC">=</span><span class="STRN">'National case law'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>662</span> </span><span class="WHIT">			</span><span class="NAME">this.removeLink</span><span class="PUNC">=</span><span class="STRN">'Remove a link'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>663</span> </span><span class="WHIT">			</span><span class="NAME">this.processingLinksMessage</span><span class="PUNC">=</span><span class="STRN">'Check for links...'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>664</span> </span><span class="WHIT">			</span><span class="NAME">this.confirmCheckForLinks</span><span class="PUNC">=</span><span class="STRN">'EULinksChecker will check for the existence of references to EU legislation and case law and will set links to the cited legal acts. This may take a while. Please, confirm!'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>665</span> </span><span class="WHIT">			</span><span class="NAME">this.confirmRemoveLinks</span><span class="PUNC">=</span><span class="STRN">'Please confirm the removal of links set by EULinksChecker.'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>666</span> </span><span class="WHIT">			</span><span class="NAME">this.cMsgNoLinksSetByELCFound</span><span class="PUNC">=</span><span class="STRN">'No links set by EULinksChecker have been found.'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>667</span> </span><span class="WHIT">			</span><span class="NAME">this.cPlsSelLink</span><span class="PUNC">=</span><span class="STRN">'Please select text with links set by EULinksChecker.'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>668</span> </span><span class="WHIT">			</span><span class="NAME">this.cPlzConfirmRmLnkSel</span><span class="PUNC">=</span><span class="STRN">'The links set by EULinksChecker will be removed. Please confirm!'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>669</span> </span><span class="WHIT">			</span><span class="NAME">this.cSuccess</span><span class="PUNC">=</span><span class="STRN">'Check for links completed.'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>670</span> </span><span class="WHIT">			</span><span class="NAME">this.cWaitUntilAsyncEnd</span><span class="PUNC">=</span><span class="STRN">'Please wait for the asynchronous operation to end.'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>671</span> </span><span class="WHIT">			</span><span class="NAME">this.msgLoading</span><span class="PUNC">=</span><span class="STRN">'Loading...'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>672</span> </span><span class="WHIT">			</span><span class="NAME">this.msgErrorHintLoading</span><span class="PUNC">=</span><span class="STRN">'An error during loading occured! For more information: &lt;a href="http://www.help.eucases.eu/ieaddin" target="_blank">www.help.eucases.eu/ieaddin&lt;/a>'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>673</span> </span><span class="WHIT">			</span><span class="NAME">this.cLang</span><span class="PUNC">=</span><span class="STRN">'User interface language'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>674</span> </span><span class="WHIT">			</span><span class="NAME">this.OK</span><span class="PUNC">=</span><span class="STRN">'OK'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>675</span> </span><span class="WHIT">			</span><span class="NAME">this.Cancel</span><span class="PUNC">=</span><span class="STRN">'Cancel'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>676</span> </span><span class="WHIT">			</span><span class="NAME">this.cYes</span><span class="PUNC">=</span><span class="STRN">'Yes'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>677</span> </span><span class="WHIT">			</span><span class="NAME">this.cNo</span><span class="PUNC">=</span><span class="STRN">'No'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>678</span> </span><span class="WHIT">			</span><span class="NAME">this.cMsgChgLng</span><span class="PUNC">=</span><span class="STRN">'You are about to change the user interface language.'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>679</span> </span><span class="WHIT">			</span><span class="NAME">this.cCheckFrLinks</span><span class="PUNC">=</span><span class="STRN">'Check for links'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>680</span> </span><span class="WHIT">			</span><span class="NAME">this.cRemoveLinks</span><span class="PUNC">=</span><span class="STRN">'Remove the links'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>681</span> </span><span class="WHIT">			</span><span class="NAME">this.cInsertLink</span><span class="PUNC">=</span><span class="STRN">'Insert a link'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>682</span> </span><span class="WHIT">			</span><span class="NAME">this.cRemoveLinksSel</span><span class="PUNC">=</span><span class="STRN">'Remove the links from the selection'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>683</span> </span><span class="WHIT">			</span><span class="NAME">this.Save2Xml</span><span class="PUNC">=</span><span class="STRN">'Save text as XML-file'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>684</span> </span><span class="WHIT">			</span><span class="NAME">this.cm_Credentials</span><span class="PUNC">=</span><span class="STRN">'Settings'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>685</span> </span><span class="WHIT">			</span><span class="NAME">this.cLinksRemoved</span><span class="PUNC">=</span><span class="STRN">'The links have been removed.'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>686</span> </span><span class="WHIT">			</span><span class="NAME">this.cLinksRemovedFromSel</span><span class="PUNC">=</span><span class="STRN">'The links have been removed from the selection.'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>687</span> </span><span class="WHIT">			</span><span class="NAME">this.cPlzInpulLink</span><span class="PUNC">=</span><span class="STRN">'Please, enter an address:'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>688</span> </span><span class="WHIT">			</span><span class="NAME">this.cInformation</span><span class="PUNC">=</span><span class="STRN">'Information'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>689</span> </span><span class="WHIT">			</span><span class="NAME">this.cWarning</span><span class="PUNC">=</span><span class="STRN">'Warning'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>690</span> </span><span class="WHIT">			</span><span class="NAME">this.cError</span><span class="PUNC">=</span><span class="STRN">'Error'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>691</span> </span><span class="WHIT">			</span><span class="NAME">this.cException</span><span class="PUNC">=</span><span class="STRN">'Exception'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>692</span> </span><span class="WHIT">			</span><span class="NAME">this.cQuestion</span><span class="PUNC">=</span><span class="STRN">'Question'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>693</span> </span><span class="WHIT">			</span><span class="NAME">this.cNoLinksInSel</span><span class="PUNC">=</span><span class="STRN">'No links in the selection'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>694</span> </span><span class="WHIT">			</span><span class="NAME">this.cNoSelection</span><span class="PUNC">=</span><span class="STRN">'Nothing is selected.'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>695</span> </span><span class="WHIT">			</span><span class="NAME">this.cInsLinkSucc</span><span class="PUNC">=</span><span class="STRN">'The setting of a link secceeded.'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>696</span> </span><span class="WHIT">			</span><span class="NAME">this.cAttention</span><span class="PUNC">=</span><span class="STRN">'Attention'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>697</span> </span><span class="WHIT">			</span><span class="NAME">this.shortCite</span><span class="PUNC">=</span><span class="STRN">'Short citation'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>698</span> </span><span class="WHIT">			</span><span class="NAME">this.fullCite</span><span class="PUNC">=</span><span class="STRN">'Full citation'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>699</span> </span><span class="WHIT">			</span><span class="NAME">this.cTarget4NewLink</span><span class="PUNC">=</span><span class="STRN">'Let new links open in:'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>700</span> </span><span class="WHIT">			</span><span class="NAME">this.cTarget4NewLink_Blank</span><span class="PUNC">=</span><span class="STRN">'a new window'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>701</span> </span><span class="WHIT">			</span><span class="NAME">this.cTarget4NewLink_Self</span><span class="PUNC">=</span><span class="STRN">'the same window'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>702</span> </span><span class="WHIT">			</span><span class="NAME">this.cStPutLinksAndTerms</span><span class="PUNC">=</span><span class="STRN">'Recognition and highlighting of references to EU legislation and case law'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>703</span> </span><span class="WHIT">			</span><span class="NAME">this.cStAddNewLink</span><span class="PUNC">=</span><span class="STRN">'Manual insertion of a link to external web resource'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>704</span> </span><span class="WHIT">			</span><span class="NAME">this.cStCredentials</span><span class="PUNC">=</span><span class="STRN">'Settings'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>705</span> </span><span class="WHIT">			</span><span class="NAME">this.cStRemove1</span><span class="PUNC">=</span><span class="STRN">'Removing links to EU legislation and case law set by EULinksChecker from the selected text'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>706</span> </span><span class="WHIT">			</span><span class="NAME">this.cStRemoveLinksAndTerms</span><span class="PUNC">=</span><span class="STRN">'Removal of links to EU legislation and case law set by "Check for links" function of EULinksChecker'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>707</span> </span><span class="WHIT">			</span><span class="NAME">this.cStSave2Xml</span><span class="PUNC">=</span><span class="STRN">'Save text to XML-file'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>708</span> </span><span class="WHIT">			</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>709</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">'it'</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>710</span> </span><span class="WHIT">			</span><span class="NAME">this.allDocs</span><span class="PUNC">=</span><span class="STRN">'Tutti i documenti'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>711</span> </span><span class="WHIT">			</span><span class="NAME">this.euLegislation</span><span class="PUNC">=</span><span class="STRN">'Legislazione UE'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>712</span> </span><span class="WHIT">			</span><span class="NAME">this.euCaseLaw</span><span class="PUNC">=</span><span class="STRN">'Giurisprudenza dell\'UE'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>713</span> </span><span class="WHIT">			</span><span class="NAME">this.natLegislation</span><span class="PUNC">=</span><span class="STRN">'Legislazione nazionale'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>714</span> </span><span class="WHIT">			</span><span class="NAME">this.natCaseLaw</span><span class="PUNC">=</span><span class="STRN">'Giurisprudenza nazionale'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>715</span> </span><span class="WHIT">			</span><span class="NAME">this.removeLink</span><span class="PUNC">=</span><span class="STRN">'Rimuovi collegamento'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>716</span> </span><span class="WHIT">			</span><span class="NAME">this.processingLinksMessage</span><span class="PUNC">=</span><span class="STRN">'Verificare la presenza dei collegamenti...'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>717</span> </span><span class="WHIT">			</span><span class="NAME">this.confirmCheckForLinks</span><span class="PUNC">=</span><span class="STRN">'EULinksChecker verificher la presenza di riferimenti alla legislazione e alla giurisprudenza dell\'UE e metter collegamenti ai testi normativi citati. Questo potrebbe richiedere del tempo. Si prega di confermare!'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>718</span> </span><span class="WHIT">			</span><span class="NAME">this.confirmRemoveLinks</span><span class="PUNC">=</span><span class="STRN">'Si prega di confermare l\'eliminazione di collegamenti messi dal EULinksChecker.'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>719</span> </span><span class="WHIT">			</span><span class="NAME">this.cMsgNoLinksSetByELCFound</span><span class="PUNC">=</span><span class="STRN">'Nessun collegamento messo dal EULinksChecker e stato trovato.'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>720</span> </span><span class="WHIT">			</span><span class="NAME">this.cPlsSelLink</span><span class="PUNC">=</span><span class="STRN">'Si prega di selezionare testo con collegamenti messi dal EULinksChecker.'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>721</span> </span><span class="WHIT">			</span><span class="NAME">this.cPlzConfirmRmLnkSel</span><span class="PUNC">=</span><span class="STRN">'I collegamenti messi dal EULinksChecker saranno rimossi. Si prega di confermare!'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>722</span> </span><span class="WHIT">			</span><span class="NAME">this.cSuccess</span><span class="PUNC">=</span><span class="STRN">'Verificazione dei collegamenti compiuta.'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>723</span> </span><span class="WHIT">			</span><span class="NAME">this.cWaitUntilAsyncEnd</span><span class="PUNC">=</span><span class="STRN">'Si prega di attendere il completamento dell\'operazione asincrona.'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>724</span> </span><span class="WHIT">			</span><span class="NAME">this.msgLoading</span><span class="PUNC">=</span><span class="STRN">'Caricamento...'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>725</span> </span><span class="WHIT">			</span><span class="NAME">this.msgErrorHintLoading</span><span class="PUNC">=</span><span class="STRN">'Errore! Per informazione: &lt;a href="http://www.help.eucases.eu/ieaddin" target="_blank">www.help.eucases.eu/ieaddin&lt;/a>'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>726</span> </span><span class="WHIT">			</span><span class="NAME">this.cLang</span><span class="PUNC">=</span><span class="STRN">'Lingua'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>727</span> </span><span class="WHIT">			</span><span class="NAME">this.OK</span><span class="PUNC">=</span><span class="STRN">'Conferma'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>728</span> </span><span class="WHIT">			</span><span class="NAME">this.Cancel</span><span class="PUNC">=</span><span class="STRN">'Cancellare'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>729</span> </span><span class="WHIT">			</span><span class="NAME">this.cYes</span><span class="PUNC">=</span><span class="STRN">'Si'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>730</span> </span><span class="WHIT">			</span><span class="NAME">this.cNo</span><span class="PUNC">=</span><span class="STRN">'No'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>731</span> </span><span class="WHIT">			</span><span class="NAME">this.cMsgChgLng</span><span class="PUNC">=</span><span class="STRN">'Questa azione modificher la lingua dell\'interfaccia utente.'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>732</span> </span><span class="WHIT">			</span><span class="NAME">this.cCheckFrLinks</span><span class="PUNC">=</span><span class="STRN">'Verificare la presenza di collegamenti'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>733</span> </span><span class="WHIT">			</span><span class="NAME">this.cRemoveLinks</span><span class="PUNC">=</span><span class="STRN">'Rimuovere collegamenti'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>734</span> </span><span class="WHIT">			</span><span class="NAME">this.cInsertLink</span><span class="PUNC">=</span><span class="STRN">'Inserisci collegamento'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>735</span> </span><span class="WHIT">			</span><span class="NAME">this.cRemoveLinksSel</span><span class="PUNC">=</span><span class="STRN">'Rimuovere collegamenti dal selezione'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>736</span> </span><span class="WHIT">			</span><span class="NAME">this.Save2Xml</span><span class="PUNC">=</span><span class="STRN">'Salva il testo come file XML'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>737</span> </span><span class="WHIT">			</span><span class="NAME">this.cm_Credentials</span><span class="PUNC">=</span><span class="STRN">'Impostazioni'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>738</span> </span><span class="WHIT">			</span><span class="NAME">this.cLinksRemoved</span><span class="PUNC">=</span><span class="STRN">'I collegamenti sono stati rimossi.'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>739</span> </span><span class="WHIT">			</span><span class="NAME">this.cLinksRemovedFromSel</span><span class="PUNC">=</span><span class="STRN">'I collegamenti sono stati rimossi dalla selezione.'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>740</span> </span><span class="WHIT">			</span><span class="NAME">this.cPlzInpulLink</span><span class="PUNC">=</span><span class="STRN">'Si prega di inserire indirizzo:'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>741</span> </span><span class="WHIT">			</span><span class="NAME">this.cInformation</span><span class="PUNC">=</span><span class="STRN">'Informazione'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>742</span> </span><span class="WHIT">			</span><span class="NAME">this.cWarning</span><span class="PUNC">=</span><span class="STRN">'Avvertimento'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>743</span> </span><span class="WHIT">			</span><span class="NAME">this.cError</span><span class="PUNC">=</span><span class="STRN">'Errore'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>744</span> </span><span class="WHIT">			</span><span class="NAME">this.cException</span><span class="PUNC">=</span><span class="STRN">'Eccezione'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>745</span> </span><span class="WHIT">			</span><span class="NAME">this.cQuestion</span><span class="PUNC">=</span><span class="STRN">'Domanda'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>746</span> </span><span class="WHIT">			</span><span class="NAME">this.cNoLinksInSel</span><span class="PUNC">=</span><span class="STRN">'Nessun link nella selezione'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>747</span> </span><span class="WHIT">			</span><span class="NAME">this.cNoSelection</span><span class="PUNC">=</span><span class="STRN">'Niente selezionato.'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>748</span> </span><span class="WHIT">			</span><span class="NAME">this.cInsLinkSucc</span><span class="PUNC">=</span><span class="STRN">'Il link e messo successivamente.'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>749</span> </span><span class="WHIT">			</span><span class="NAME">this.cAttention</span><span class="PUNC">=</span><span class="STRN">'Attenzione'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>750</span> </span><span class="WHIT">			</span><span class="NAME">this.shortCite</span><span class="PUNC">=</span><span class="STRN">'Citazione breve'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>751</span> </span><span class="WHIT">			</span><span class="NAME">this.fullCite</span><span class="PUNC">=</span><span class="STRN">'Citazione completa'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>752</span> </span><span class="WHIT">			</span><span class="NAME">this.cTarget4NewLink</span><span class="PUNC">=</span><span class="STRN">'I nuovi link si aprono in :'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>753</span> </span><span class="WHIT">			</span><span class="NAME">this.cTarget4NewLink_Blank</span><span class="PUNC">=</span><span class="STRN">'una nuova finestra'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>754</span> </span><span class="WHIT">			</span><span class="NAME">this.cTarget4NewLink_Self</span><span class="PUNC">=</span><span class="STRN">'la stessa finestra'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>755</span> </span><span class="WHIT">			</span><span class="NAME">this.cStPutLinksAndTerms</span><span class="PUNC">=</span><span class="STRN">'Identificazione e marcatura di riferimenti alla legislazione e alla giurisprudenza dell\'Unione europea'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>756</span> </span><span class="WHIT">			</span><span class="NAME">this.cStAddNewLink</span><span class="PUNC">=</span><span class="STRN">'Inserire manualmente un collegamento ad una risorsa web esterna'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>757</span> </span><span class="WHIT">			</span><span class="NAME">this.cStCredentials</span><span class="PUNC">=</span><span class="STRN">'Impostazioni'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>758</span> </span><span class="WHIT">			</span><span class="NAME">this.cStRemove1</span><span class="PUNC">=</span><span class="STRN">'Rimuovere i collegamenti alla legislazione e alla giurisprudenza dell\'UE messi dal EULinksChecker dal testo selezionato'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>759</span> </span><span class="WHIT">			</span><span class="NAME">this.cStRemoveLinksAndTerms</span><span class="PUNC">=</span><span class="STRN">'Rimuovere i collegamenti alla legislazione e alla giurisprudenza dell\'UE messi dal EULinksChecker con la funzione "Verifica la presenza di collegamenti".'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>760</span> </span><span class="WHIT">			</span><span class="NAME">this.cStSave2Xml</span><span class="PUNC">=</span><span class="STRN">'Salva il testo come file XML'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>761</span> </span><span class="WHIT">			</span><span class="KEYW">break</span><span class="WHIT">
<span class='line'>762</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>763</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>764</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">aLang</span><span class="PUNC">)</span><span class="NAME">this.SetLang</span><span class="PUNC">(</span><span class="NAME">aLang</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>765</span> </span><span class="WHIT">	</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">this.SetLangIdx</span><span class="PUNC">(</span><span class="NAME">GetPrefUiLang</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>766</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="WHIT">
<span class='line'>767</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>768</span> </span><span class="COMM">/** @namespace MNU
<span class='line'>769</span>  *@name MNU
<span class='line'>770</span>  @description Object instance to be used as global throughout the life cycle of the AddIn
<span class='line'>771</span>  **/</span><span class="WHIT">
<span class='line'>772</span> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">MNU</span><span class="PUNC">)</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">MNU</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>773</span> </span><span class="COMM">/** @namespace MNU.o
<span class='line'>774</span>  * @name MNU.o
<span class='line'>775</span>   @description The main member of the MNU object
<span class='line'>776</span>   */</span><span class="WHIT">
<span class='line'>777</span> </span><span class="NAME">MNU.o</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>778</span> </span><span class="COMM">/** private*/</span><span class="WHIT">
<span class='line'>779</span> </span><span class="WHIT">	</span><span class="NAME">CurrentDoc</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>780</span> </span><span class="WHIT">	</span><span class="NAME">CurrentDocBody</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>781</span> </span><span class="WHIT">	</span><span class="NAME">CurrentBusy</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>782</span> </span><span class="WHIT">	</span><span class="NAME">mLinkAtCrs</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>783</span> </span><span class="COMM">/** @method eucasesSetLinks
<span class='line'>784</span>  @description eucasesSetLinks sets links to recognized acts, represents the main functionality
<span class='line'>785</span>  **/</span><span class="WHIT">
<span class='line'>786</span> </span><span class="WHIT">	</span><span class="NAME">eucasesSetLinks</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>787</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">MNU.o.CurrentDocBody</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">x</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Rsrc</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">Msg</span><span class="PUNC">(</span><span class="NAME">x.cWaitUntilAsyncEnd</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>788</span> </span><span class="WHIT">		</span><span class="NAME">ShowBusy</span><span class="PUNC">(</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>789</span> </span><span class="NAME">AddScrHT</span><span class="PUNC">(</span><span class="NAME">Doc</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="STRN">'var EUCASES_UI_LANG="'</span><span class="PUNC">+</span><span class="NAME">LANG</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">'";'</span><span class="PUNC">,</span><span class="NAME">cVarsId</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>790</span> </span><span class="WHIT">		</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">DocBodyHtml</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>791</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">==</span><span class="STRN">''</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Msg</span><span class="PUNC">(</span><span class="STRN">'No selection'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>792</span> </span><span class="WHIT">		</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">x</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">XMLHttpRequest</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>793</span> </span><span class="WHIT">		</span><span class="COMM">/** @private */</span><span class="WHIT">
<span class='line'>794</span> </span><span class="WHIT">		</span><span class="NAME">x.onreadystatechange</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>795</span> </span><span class="WHIT">			</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">r</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Rsrc</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>796</span> </span><span class="WHIT">			</span><span class="NAME">AddScrHT</span><span class="PUNC">(</span><span class="NAME">MNU.o.CurrentDoc</span><span class="PUNC">,</span><span class="STRN">'var EUCASES_UI_LANG="'</span><span class="PUNC">+</span><span class="NAME">LANG</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">'";'</span><span class="PUNC">,</span><span class="NAME">cVarsId</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>797</span> </span><span class="WHIT">			</span><span class="NAME">AddScrHT</span><span class="PUNC">(</span><span class="NAME">MNU.o.CurrentDoc</span><span class="PUNC">,</span><span class="STRN">'EUCASES_UI_LANG="'</span><span class="PUNC">+</span><span class="NAME">LANG</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">'";'</span><span class="PUNC">,</span><span class="NAME">cVars1Id</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>798</span> </span><span class="KEYW">try</span><span class="PUNC">{</span><span class="NAME">MNU.o.CurrentDoc.EUCASES_UI_LANG</span><span class="PUNC">=</span><span class="NAME">LANG</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">catch</span><span class="PUNC">(</span><span class="NAME">_</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>799</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">x.readyState</span><span class="PUNC">==</span><span class="NUMB">4</span><span class="PUNC">&&</span><span class="NAME">x.status</span><span class="PUNC">==</span><span class="NUMB">200</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>800</span> </span><span class="WHIT">				</span><span class="NAME">AddCssH</span><span class="PUNC">(</span><span class="NAME">MNU.o.CurrentDoc</span><span class="PUNC">,</span><span class="NAME">cStyleId</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>801</span> </span><span class="WHIT">				</span><span class="NAME">AddScrHT</span><span class="PUNC">(</span><span class="NAME">MNU.o.CurrentDoc</span><span class="PUNC">,</span><span class="STRN">'var EUCASES_UI_LANG="'</span><span class="PUNC">+</span><span class="NAME">LANG</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">'";'</span><span class="PUNC">,</span><span class="NAME">cVarsId</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>802</span> </span><span class="WHIT">				</span><span class="NAME">MNU.o.CurrentDocBody.innerHTML</span><span class="PUNC">=</span><span class="NAME">x.responseText</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>803</span> </span><span class="WHIT">				</span><span class="NAME">AddScrH</span><span class="PUNC">(</span><span class="NAME">MNU.o.CurrentDoc</span><span class="PUNC">,</span><span class="NAME">cCommonProcsId</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>804</span> </span><span class="WHIT">				</span><span class="NAME">ShowBusy</span><span class="PUNC">(</span><span class="KEYW">false</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>805</span> </span><span class="WHIT">				</span><span class="NAME">MNU.o.CurrentBusy</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>806</span> </span><span class="WHIT">				</span><span class="NAME">MNU.o.CurrentDocBody</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="WHIT">
<span class='line'>807</span> </span><span class="WHIT">				</span><span class="NAME">MNU.o.CurrentDoc</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>808</span> </span><span class="WHIT">				</span><span class="NAME">Msg</span><span class="PUNC">(</span><span class="NAME">r.cSuccess</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>809</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>810</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>811</span> </span><span class="WHIT">		</span><span class="NAME">x.open</span><span class="PUNC">(</span><span class="STRN">'POST'</span><span class="PUNC">,</span><span class="STRN">'http://techno.eucases.eu/FrontEndREST/api/Links/PutHtmlLinks/'</span><span class="PUNC">,</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>812</span> </span><span class="WHIT">		</span><span class="NAME">x.setRequestHeader</span><span class="PUNC">(</span><span class="STRN">'Content-type'</span><span class="PUNC">,</span><span class="STRN">'application/x-www-form-urlencoded'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>813</span> </span><span class="WHIT">		</span><span class="NAME">x.setRequestHeader</span><span class="PUNC">(</span><span class="STRN">'UI-Language'</span><span class="PUNC">,</span><span class="NAME">LANG</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>814</span> </span><span class="WHIT">		</span><span class="NAME">x.send</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>815</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>816</span> </span><span class="COMM">/** @method eucasesDownloadXml
<span class='line'>817</span>  @description eucasesDownloadXml provides download xml file corresponding to the current
<span class='line'>818</span>  **/</span><span class="WHIT">
<span class='line'>819</span> </span><span class="WHIT">	</span><span class="NAME">eucasesDownloadXml</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>820</span> </span><span class="WHIT">		</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">Doc</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">d.createElement</span><span class="PUNC">(</span><span class="STRN">'form'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>821</span> </span><span class="WHIT">		</span><span class="NAME">f.action</span><span class="PUNC">=</span><span class="STRN">'http://techno.eucases.eu/FrontEndREST/api/Links/GenerateXmlFromDoubleEncoded'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>822</span> </span><span class="WHIT">		</span><span class="NAME">f.method</span><span class="PUNC">=</span><span class="STRN">'post'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>823</span> </span><span class="WHIT">		</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">d.createElement</span><span class="PUNC">(</span><span class="STRN">'input'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>824</span> </span><span class="WHIT">		</span><span class="NAME">i.type</span><span class="PUNC">=</span><span class="STRN">'text'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>825</span> </span><span class="WHIT">		</span><span class="NAME">i.name</span><span class="PUNC">=</span><span class="STRN">'html'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>826</span> </span><span class="WHIT">		</span><span class="NAME">i.value</span><span class="PUNC">=</span><span class="NAME">encodeURI</span><span class="PUNC">(</span><span class="NAME">DocBody</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">outerHTML</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>827</span> </span><span class="WHIT">		</span><span class="NAME">f.appendChild</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>828</span> </span><span class="WHIT">		</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">d.createElement</span><span class="PUNC">(</span><span class="STRN">'input'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>829</span> </span><span class="WHIT">		</span><span class="NAME">s.type</span><span class="PUNC">=</span><span class="STRN">'submit'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>830</span> </span><span class="WHIT">		</span><span class="NAME">f.appendChild</span><span class="PUNC">(</span><span class="NAME">s</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>831</span> </span><span class="WHIT">		</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">d.body</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>832</span> </span><span class="WHIT">		</span><span class="NAME">d.appendChild</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>833</span> </span><span class="WHIT">		</span><span class="NAME">s.click</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>834</span> </span><span class="WHIT">		</span><span class="NAME">d.removeChild</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>835</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>836</span> </span><span class="COMM">/** @description HasSelection is a private member to determine if there's a selection*/</span><span class="WHIT">
<span class='line'>837</span> </span><span class="WHIT">	</span><span class="NAME">HasSelection</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">GetSelTxt</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">!=</span><span class="STRN">''</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>838</span> </span><span class="COMM">/** @method @description Removes a single link
<span class='line'>839</span>   @param e The window.event object automatically passed.
<span class='line'>840</span>  **/</span><span class="WHIT">
<span class='line'>841</span> </span><span class="WHIT">	</span><span class="NAME">RemoveLink</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Rm1Lnk</span><span class="PUNC">(</span><span class="NAME">MNU.o.mLinkAtCrs</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>842</span> </span><span class="COMM">/** @description Removes all the links within the selection which were previously set by the plugin
<span class='line'>843</span>   @param e The window.event object automatically passed.
<span class='line'>844</span>  **/</span><span class="WHIT">
<span class='line'>845</span> </span><span class="WHIT">	</span><span class="NAME">RemoveLinksSel</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>846</span> </span><span class="WHIT">		</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">OurLinksInSel</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>847</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">a</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>848</span> </span><span class="WHIT">		</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">r</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Rsrc</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>849</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">Qst</span><span class="PUNC">(</span><span class="NAME">r.cPlzConfirmRmLnkSel</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>850</span> </span><span class="WHIT">		</span><span class="NAME">a.forEach</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">_</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Rm1Lnk</span><span class="PUNC">(</span><span class="NAME">_</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="COMM">//for(let i=0;i&lt;a.length;i++)Rm1Lnk(a[i]);</span><span class="WHIT">
<span class='line'>851</span> </span><span class="WHIT">		</span><span class="NAME">Msg</span><span class="PUNC">(</span><span class="NAME">r.cLinksRemovedFromSel</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>852</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>853</span> </span><span class="COMM">/** @description Converts the selection into link provided a HREF was specified during the procedure.
<span class='line'>854</span>   @param e The window.event object automatically passed.
<span class='line'>855</span>  * Remark 1: does not work without selection.
<span class='line'>856</span>  * Remark 2: does not work if no link specified.
<span class='line'>857</span>  * Remark 3: could not be removed by RemoveLink or RemoveLinksSel.
<span class='line'>858</span>  **/</span><span class="WHIT">
<span class='line'>859</span> </span><span class="WHIT">	</span><span class="NAME">InsertLink</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>860</span> </span><span class="WHIT">		</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">MNU.o.HasSelection</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Rsrc</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>861</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Msg</span><span class="PUNC">(</span><span class="NAME">r.cNoSelection</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>862</span> </span><span class="WHIT">		</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">l</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">v</span><span class="PUNC">:</span><span class="NAME">cHttp_</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">Inp</span><span class="PUNC">(</span><span class="NAME">r.cPlzInpulLink</span><span class="PUNC">,</span><span class="NAME">ctQ</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>863</span> </span><span class="WHIT">		</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">GetSelTxt</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>864</span> </span><span class="WHIT">		</span><span class="NAME">_s</span><span class="PUNC">(</span><span class="STRN">'&lt;a href="'</span><span class="PUNC">+</span><span class="NAME">l.v</span><span class="PUNC">+</span><span class="STRN">'" target="'</span><span class="PUNC">+</span><span class="NAME">GetPrefNewLinkTarget</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">'">'</span><span class="PUNC">+</span><span class="NAME">s</span><span class="PUNC">+</span><span class="STRN">'&lt;/a>'</span><span class="PUNC">,</span><span class="KEYW">false</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>865</span> </span><span class="WHIT">		</span><span class="NAME">Msg</span><span class="PUNC">(</span><span class="NAME">r.cInsLinkSucc</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>866</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>867</span> </span><span class="COMM">/** @description entry point to expose the main functionality via menuitem
<span class='line'>868</span>   @param e The window.event object automatically passed.
<span class='line'>869</span>  **/</span><span class="WHIT">
<span class='line'>870</span> </span><span class="WHIT">	</span><span class="NAME">EI1</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.eucasesSetLinks</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>871</span> </span><span class="COMM">/** @description Entry point to expose the removehyperlinks functionality via menuitem
<span class='line'>872</span>   @param e The window.event object automatically passed.
<span class='line'>873</span>  **/</span><span class="WHIT">
<span class='line'>874</span> </span><span class="WHIT">	</span><span class="NAME">EI2</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">removehyperlinks</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>875</span> </span><span class="COMM">/** @private*/</span><span class="WHIT">
<span class='line'>876</span> </span><span class="WHIT">	</span><span class="NAME">tstTB1</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Msg</span><span class="PUNC">(</span><span class="STRN">'You\'ve just pressed me'</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>877</span> </span><span class="COMM">/** @description Entry point to expose the Settings functionality via menuitem
<span class='line'>878</span>   @param e The window.event object automatically passed.
<span class='line'>879</span>  **/</span><span class="WHIT">
<span class='line'>880</span> </span><span class="WHIT">	</span><span class="NAME">Settings</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>881</span> </span><span class="WHIT">		</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">x</span><span class="PUNC">=</span><span class="NAME">Components.classes</span><span class="PUNC">[</span><span class="STRN">'@mozilla.org/embedcomp/window-watcher;1'</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">getService</span><span class="PUNC">(</span><span class="NAME">Components.interfaces.nsIWindowWatcher</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>882</span> </span><span class="WHIT">		</span><span class="NAME">r</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Rsrc</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>883</span> </span><span class="WHIT">		</span><span class="NAME">y</span><span class="PUNC">=</span><span class="NAME">x.openWindow</span><span class="PUNC">(</span><span class="WHIT">
<span class='line'>884</span> </span><span class="WHIT">			</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>885</span> </span><span class="WHIT">			</span><span class="STRN">'chrome://MNU/content/pref.xul?Lang='</span><span class="PUNC">+</span><span class="NAME">LANG</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>886</span> </span><span class="WHIT">			</span><span class="NAME">r.cm_Credentials</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>887</span> </span><span class="WHIT">			</span><span class="STRN">'chrome,dialog,modal,centerscreen,alwaysRaised'</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>888</span> </span><span class="WHIT">			</span><span class="KEYW">null</span><span class="WHIT">
<span class='line'>889</span> </span><span class="WHIT">		</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>890</span> </span><span class="WHIT">		</span><span class="NAME">this.startup</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>891</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>892</span> </span><span class="COMM">/** @description Entry point to expose the Export to XML functionality via menuitem
<span class='line'>893</span>   @param e The window.event object automatically passed.
<span class='line'>894</span>  **/</span><span class="WHIT">
<span class='line'>895</span> </span><span class="WHIT">	</span><span class="NAME">Export2Xml</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.eucasesDownloadXml</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>896</span> </span><span class="COMM">/** @description The AddIn start-up point
<span class='line'>897</span>   @param e The window.event object automatically passed.
<span class='line'>898</span>  **/</span><span class="WHIT">
<span class='line'>899</span> </span><span class="WHIT">	</span><span class="NAME">startup</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>900</span> </span><span class="WHIT">		</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">x</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Rsrc</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>901</span> </span><span class="WHIT">		</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">document.getElementById</span><span class="PUNC">(</span><span class="STRN">'tbbCheck4LinksId'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">o</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">o.label</span><span class="PUNC">=</span><span class="NAME">x.cCheckFrLinks</span><span class="PUNC">;</span><span class="NAME">o.tooltipText</span><span class="PUNC">=</span><span class="NAME">x.cStPutLinksAndTerms</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>902</span> </span><span class="WHIT">		</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">document.getElementById</span><span class="PUNC">(</span><span class="STRN">'tbbRmAllLinksId'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">o</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">o.label</span><span class="PUNC">=</span><span class="NAME">x.cRemoveLinks</span><span class="PUNC">;</span><span class="NAME">o.tooltipText</span><span class="PUNC">=</span><span class="NAME">x.cStRemoveLinksAndTerms</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>903</span> </span><span class="WHIT">		</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">document.getElementById</span><span class="PUNC">(</span><span class="STRN">'tbbInsertLink'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">o</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">o.label</span><span class="PUNC">=</span><span class="NAME">x.cInsertLink</span><span class="PUNC">;</span><span class="NAME">o.tooltipText</span><span class="PUNC">=</span><span class="NAME">x.cStAddNewLink</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>904</span> </span><span class="WHIT">		</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">document.getElementById</span><span class="PUNC">(</span><span class="STRN">'tbbRmLinksSelId'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">o</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">o.label</span><span class="PUNC">=</span><span class="NAME">x.cRemoveLinksSel</span><span class="PUNC">;</span><span class="NAME">o.tooltipText</span><span class="PUNC">=</span><span class="NAME">x.cStRemove1</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>905</span> </span><span class="WHIT">		</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">document.getElementById</span><span class="PUNC">(</span><span class="STRN">'tbbXmlId'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">o</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">o.label</span><span class="PUNC">=</span><span class="NAME">x.Save2Xml</span><span class="PUNC">;</span><span class="NAME">o.tooltipText</span><span class="PUNC">=</span><span class="NAME">x.cStSave2Xml</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>906</span> </span><span class="WHIT">		</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">document.getElementById</span><span class="PUNC">(</span><span class="STRN">'tbbSettingsId'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">o</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">o.label</span><span class="PUNC">=</span><span class="NAME">x.cm_Credentials</span><span class="PUNC">;</span><span class="NAME">o.tooltipText</span><span class="PUNC">=</span><span class="NAME">x.cStCredentials</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>907</span> </span><span class="WHIT">		</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">document.getElementById</span><span class="PUNC">(</span><span class="STRN">'MNU-EUL-menu-item1'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">o</span><span class="PUNC">)</span><span class="NAME">o.label</span><span class="PUNC">=</span><span class="NAME">x.cCheckFrLinks</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>908</span> </span><span class="WHIT">		</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">document.getElementById</span><span class="PUNC">(</span><span class="STRN">'MNU-EUL-menu-item2'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">o</span><span class="PUNC">)</span><span class="NAME">o.label</span><span class="PUNC">=</span><span class="NAME">x.cRemoveLinks</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>909</span> </span><span class="WHIT">		</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">document.getElementById</span><span class="PUNC">(</span><span class="STRN">'miXml'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">o</span><span class="PUNC">)</span><span class="NAME">o.label</span><span class="PUNC">=</span><span class="NAME">x.Save2Xml</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>910</span> </span><span class="WHIT">		</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">document.getElementById</span><span class="PUNC">(</span><span class="STRN">'miSettingsId'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">o</span><span class="PUNC">)</span><span class="NAME">o.label</span><span class="PUNC">=</span><span class="NAME">x.cm_Credentials</span><span class="WHIT">
<span class='line'>911</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>912</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>913</span> </span><span class="COMM">/** @private */</span><span class="WHIT">
<span class='line'>914</span> </span><span class="NAME">window.addEventListener</span><span class="PUNC">(</span><span class="STRN">'load'</span><span class="PUNC">,</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">event</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">MNU.o.startup</span><span class="PUNC">(</span><span class="NAME">event</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="KEYW">false</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>915</span> </span><span class="COMM">/** @private */</span><span class="WHIT">
<span class='line'>916</span> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">HelloTo_callBack</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Msg</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>917</span> </span><span class="COMM">/** @private*/</span><span class="WHIT">
<span class='line'>918</span> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">_st</span><span class="PUNC">(</span><span class="NAME">o</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>919</span> </span><span class="WHIT">	</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">GetElById</span><span class="PUNC">(</span><span class="NAME">o</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>920</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">o</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>921</span> </span><span class="WHIT">	</span><span class="NAME">o.disabled</span><span class="PUNC">=</span><span class="NAME">o.hidden</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>922</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>923</span> </span><span class="WHIT">	</span><span class="NAME">o.label</span><span class="PUNC">=</span><span class="NAME">l</span><span class="WHIT">
<span class='line'>924</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>925</span> </span><span class="COMM">/** @private 
<span class='line'>926</span>     @param event The event object.
<span class='line'>927</span>  */</span><span class="WHIT">
<span class='line'>928</span> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">PROC</span><span class="PUNC">(</span><span class="NAME">event</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>929</span> </span><span class="WHIT">	</span><span class="NAME">MNU.o.mLinkAtCrs</span><span class="PUNC">=</span><span class="NAME">LinkAtCursor</span><span class="PUNC">(</span><span class="NAME">event</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>930</span> </span><span class="WHIT">	</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">x</span><span class="PUNC">=</span><span class="NAME">Rsrc</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">OurLinksInSel</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">LinksInSel</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">GetSelTxt</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">s</span><span class="PUNC">?</span><span class="NAME">s.length</span><span class="PUNC">==</span><span class="NUMB">0</span><span class="PUNC">:</span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>931</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">==</span><span class="STRN">''</span><span class="PUNC">)</span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">true</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">&&</span><span class="NAME">l.length</span><span class="PUNC">></span><span class="NUMB">0</span><span class="PUNC">)</span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">true</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>932</span> </span><span class="WHIT">	</span><span class="KEYW">try</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>933</span> </span><span class="WHIT">		</span><span class="NAME">_st</span><span class="PUNC">(</span><span class="STRN">'RemoveLinksSel'</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">,</span><span class="NAME">x.cRemoveLinksSel</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>934</span> </span><span class="WHIT">		</span><span class="NAME">_st</span><span class="PUNC">(</span><span class="STRN">'RemoveLink'</span><span class="PUNC">,</span><span class="NAME">MNU.o.mLinkAtCrs</span><span class="PUNC">!=</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">x.cRemoveLinks</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>935</span> </span><span class="WHIT">		</span><span class="NAME">_st</span><span class="PUNC">(</span><span class="STRN">'InsertLink'</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">x.cInsertLink</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>936</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="KEYW">catch</span><span class="PUNC">(</span><span class="NAME">_</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">console.log</span><span class="PUNC">(</span><span class="NAME">_.message</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>937</span> </span><span class="WHIT">	</span><span class="NAME">updateEditUIVisibility</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>938</span> </span><span class="WHIT">	</span><span class="NAME">gContextMenu</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">nsContextMenu</span><span class="PUNC">(</span><span class="NAME">window.content.document</span><span class="PUNC">,</span><span class="NAME">event.shiftKey</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>939</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">gContextMenu.shouldDisplay</span><span class="PUNC">)</span><span class="NAME">updateEditUIVisibility</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>940</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">gContextMenu.shouldDisplay</span><span class="WHIT">
<span class='line'>941</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>942</span> </span><span class="COMM">/** @private*/</span><span class="WHIT">
<span class='line'>943</span> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">AddScrHT</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>944</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">==</span><span class="STRN">''</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>945</span> </span><span class="COMM">//	if(i)if(d.getElementById(i))return;</span><span class="WHIT">
<span class='line'>946</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>947</span> </span><span class="WHIT">		</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">d.getElementById</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>948</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="NAME">e.parentNode.removeChild</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>949</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>950</span> </span><span class="WHIT">	</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">d.getElementsByTagName</span><span class="PUNC">(</span><span class="NAME">cHead</span><span class="PUNC">)</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">d.createElement</span><span class="PUNC">(</span><span class="STRN">'script'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>951</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">)</span><span class="NAME">s.id</span><span class="PUNC">=</span><span class="NAME">i</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>952</span> </span><span class="WHIT">	</span><span class="NAME">s.type</span><span class="PUNC">=</span><span class="STRN">'text/javascript'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>953</span> </span><span class="WHIT">	</span><span class="COMM">//s.defer='defer';</span><span class="WHIT">
<span class='line'>954</span> </span><span class="WHIT">	</span><span class="NAME">s.text</span><span class="PUNC">=</span><span class="NAME">t</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>955</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">)</span><span class="NAME">h.appendChild</span><span class="PUNC">(</span><span class="NAME">s</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>956</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>957</span> </span><span class="COMM">/** @private*/</span><span class="WHIT">
<span class='line'>958</span> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">AddScrH</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">AddScrHT</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">HG</span><span class="PUNC">(</span><span class="STRN">'http://techno.eucases.eu/FrontEndREST/api/Links/GetResourceFile?fileName=context-menu.js'</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>959</span> </span><span class="COMM">/** @private*/</span><span class="WHIT">
<span class='line'>960</span> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">AddCssH</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>961</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">d.getElementById</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>962</span> </span><span class="WHIT">	</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">HG</span><span class="PUNC">(</span><span class="STRN">'http://techno.eucases.eu/FrontEndREST/api/Links/GetResourceFile?fileName=context-menu.css'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>963</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">==</span><span class="STRN">''</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>964</span> </span><span class="WHIT">	</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">d.getElementsByTagName</span><span class="PUNC">(</span><span class="NAME">cHead</span><span class="PUNC">)</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">d.createElement</span><span class="PUNC">(</span><span class="STRN">'style'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>965</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">)</span><span class="NAME">s.id</span><span class="PUNC">=</span><span class="NAME">i</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>966</span> </span><span class="WHIT">	</span><span class="NAME">s.type</span><span class="PUNC">=</span><span class="STRN">'text/css'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>967</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">s.styleSheet</span><span class="PUNC">)</span><span class="NAME">s.styleSheet.cssText</span><span class="PUNC">=</span><span class="NAME">t</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">s.appendChild</span><span class="PUNC">(</span><span class="NAME">d.createTextNode</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>968</span> </span><span class="WHIT">	</span><span class="COMM">//s.text=t;</span><span class="WHIT">
<span class='line'>969</span> </span><span class="WHIT">	</span><span class="COMM">//s.src='path/to/your-script.js';</span><span class="WHIT">
<span class='line'>970</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">)</span><span class="NAME">h.appendChild</span><span class="PUNC">(</span><span class="NAME">s</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>971</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>972</span> </span><span class="COMM">/** @private*/</span><span class="WHIT">
<span class='line'>973</span> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">_PODBA</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">r</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Rsrc</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">Msg</span><span class="PUNC">(</span><span class="NAME">r.cMsgChgLng</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>974</span> </span><span class="COMM">/** @private
<span class='line'>975</span>     @param e The event object.
<span class='line'>976</span>  **/</span><span class="WHIT">
<span class='line'>977</span> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">_PODA</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">MNU.o.startup</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>978</span> </span><span class="COMM">/** @private */</span><span class="WHIT">
<span class='line'>979</span> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">_POL</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>980</span> </span><span class="WHIT">	</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">r</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Rsrc</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">=</span><span class="NAME">GetElById</span><span class="PUNC">(</span><span class="STRN">'UILangLblId'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">)</span><span class="NAME">x.value</span><span class="PUNC">=</span><span class="NAME">r.cLang</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>981</span> </span><span class="WHIT">	</span><span class="NAME">x</span><span class="PUNC">=</span><span class="NAME">GetElById</span><span class="PUNC">(</span><span class="STRN">'Settings-pane'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">)</span><span class="NAME">x.label</span><span class="PUNC">=</span><span class="NAME">r.cm_Credentials</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>982</span> </span><span class="WHIT">	</span><span class="NAME">x</span><span class="PUNC">=</span><span class="NAME">GetElById</span><span class="PUNC">(</span><span class="STRN">'NewLinkInLblId'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">)</span><span class="NAME">x.value</span><span class="PUNC">=</span><span class="NAME">r.cTarget4NewLink</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>983</span> </span><span class="WHIT">	</span><span class="NAME">x</span><span class="PUNC">=</span><span class="NAME">GetElById</span><span class="PUNC">(</span><span class="STRN">'NewLlinksIdx_1'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">)</span><span class="NAME">x.label</span><span class="PUNC">=</span><span class="NAME">r.cTarget4NewLink_Blank</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>984</span> </span><span class="WHIT">	</span><span class="NAME">x</span><span class="PUNC">=</span><span class="NAME">GetElById</span><span class="PUNC">(</span><span class="STRN">'NewLlinksIdx_2'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">)</span><span class="NAME">x.label</span><span class="PUNC">=</span><span class="NAME">r.cTarget4NewLink_Self</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>985</span> </span><span class="WHIT">	</span><span class="NAME">x</span><span class="PUNC">=</span><span class="NAME">GetElById</span><span class="PUNC">(</span><span class="STRN">'MNU-prefs'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>986</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>987</span> </span><span class="WHIT">		</span><span class="NAME">x.title</span><span class="PUNC">=</span><span class="NAME">r.cm_Credentials</span><span class="PUNC">;</span><span class="NAME">x.setAttribute</span><span class="PUNC">(</span><span class="NAME">cTitle</span><span class="PUNC">,</span><span class="NAME">r.cm_Credentials</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>988</span> </span><span class="WHIT">		</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">x.getButton</span><span class="PUNC">(</span><span class="STRN">'accept'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="NAME">b.label</span><span class="PUNC">=</span><span class="NAME">r.OK</span><span class="PUNC">;</span><span class="COMM">//b.setAttribute('image','chrome://MNU/skin/b/OK.png')</span><span class="WHIT">
<span class='line'>989</span> </span><span class="WHIT">		</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">x.getButton</span><span class="PUNC">(</span><span class="STRN">'cancel'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="NAME">b.label</span><span class="PUNC">=</span><span class="NAME">r.Cancel</span><span class="WHIT">
<span class='line'>990</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>991</span> </span><span class="PUNC">}</span></pre></body></html>